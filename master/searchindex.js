Search.setIndex({"docnames": ["examples", "framework/auto_unit", "framework/callbacks", "framework/eval", "framework/fit", "framework/generated/torchtnt.framework.callbacks.BaseCSVWriter", "framework/generated/torchtnt.framework.callbacks.GarbageCollector", "framework/generated/torchtnt.framework.callbacks.Lambda", "framework/generated/torchtnt.framework.callbacks.LearningRateMonitor", "framework/generated/torchtnt.framework.callbacks.ModuleSummary", "framework/generated/torchtnt.framework.callbacks.PyTorchProfiler", "framework/generated/torchtnt.framework.callbacks.SystemResourcesMonitor", "framework/generated/torchtnt.framework.callbacks.TQDMProgressBar", "framework/generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor", "framework/generated/torchtnt.framework.callbacks.TorchSnapshotSaver", "framework/generated/torchtnt.framework.callbacks.TrainProgressMonitor", "framework/predict", "framework/state", "framework/train", "framework/unit", "index", "utils/data", "utils/generated/torchtnt.utils.data.AllDatasetBatchesIterator", "utils/generated/torchtnt.utils.data.CudaDataPrefetcher", "utils/generated/torchtnt.utils.data.InOrderIterator", "utils/generated/torchtnt.utils.data.MultiDataLoader", "utils/generated/torchtnt.utils.data.MultiIterator", "utils/generated/torchtnt.utils.data.RandomizedBatchSamplerIterator", "utils/generated/torchtnt.utils.data.RoundRobinIterator", "utils/generated/torchtnt.utils.loggers.CSVLogger", "utils/generated/torchtnt.utils.loggers.InMemoryLogger", "utils/generated/torchtnt.utils.loggers.JSONLogger", "utils/generated/torchtnt.utils.loggers.TensorBoardLogger", "utils/loggers", "utils/utils"], "filenames": ["examples.rst", "framework/auto_unit.rst", "framework/callbacks.rst", "framework/eval.rst", "framework/fit.rst", "framework/generated/torchtnt.framework.callbacks.BaseCSVWriter.rst", "framework/generated/torchtnt.framework.callbacks.GarbageCollector.rst", "framework/generated/torchtnt.framework.callbacks.Lambda.rst", "framework/generated/torchtnt.framework.callbacks.LearningRateMonitor.rst", "framework/generated/torchtnt.framework.callbacks.ModuleSummary.rst", "framework/generated/torchtnt.framework.callbacks.PyTorchProfiler.rst", "framework/generated/torchtnt.framework.callbacks.SystemResourcesMonitor.rst", "framework/generated/torchtnt.framework.callbacks.TQDMProgressBar.rst", "framework/generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor.rst", "framework/generated/torchtnt.framework.callbacks.TorchSnapshotSaver.rst", "framework/generated/torchtnt.framework.callbacks.TrainProgressMonitor.rst", "framework/predict.rst", "framework/state.rst", "framework/train.rst", "framework/unit.rst", "index.rst", "utils/data.rst", "utils/generated/torchtnt.utils.data.AllDatasetBatchesIterator.rst", "utils/generated/torchtnt.utils.data.CudaDataPrefetcher.rst", "utils/generated/torchtnt.utils.data.InOrderIterator.rst", "utils/generated/torchtnt.utils.data.MultiDataLoader.rst", "utils/generated/torchtnt.utils.data.MultiIterator.rst", "utils/generated/torchtnt.utils.data.RandomizedBatchSamplerIterator.rst", "utils/generated/torchtnt.utils.data.RoundRobinIterator.rst", "utils/generated/torchtnt.utils.loggers.CSVLogger.rst", "utils/generated/torchtnt.utils.loggers.InMemoryLogger.rst", "utils/generated/torchtnt.utils.loggers.JSONLogger.rst", "utils/generated/torchtnt.utils.loggers.TensorBoardLogger.rst", "utils/loggers.rst", "utils/utils.rst"], "titles": ["Examples", "AutoUnit", "Callbacks", "Evaluate", "Fit", "BaseCSVWriter", "GarbageCollector", "Lambda", "LearningRateMonitor", "ModuleSummary", "PyTorchProfiler", "SystemResourcesMonitor", "TQDMProgressBar", "TensorBoardParameterMonitor", "TorchSnapshotSaver", "TrainProgressMonitor", "Predict", "State", "Train", "Unit", "Welcome to the TorchTNT documentation!", "Data", "AllDatasetBatchesIterator", "CudaDataPrefetcher", "InOrderIterator", "MultiDataLoader", "MultiIterator", "RandomizedBatchSamplerIterator", "RoundRobinIterator", "CSVLogger", "InMemoryLogger", "JSONLogger", "TensorBoardLogger", "Loggers", "Utils"], "terms": {"The": [0, 1, 3, 4, 5, 6, 9, 16, 18, 19, 25, 34], "show": 0, "how": [0, 1, 4, 22, 24, 25, 26, 27, 28], "us": [0, 1, 2, 3, 4, 9, 10, 14, 16, 17, 18, 19, 23, 27, 32, 33, 34], "basic": [0, 2, 19], "model": [0, 1, 2, 6, 14, 19, 34], "It": [0, 12, 20, 25, 34], "can": [0, 1, 2, 3, 4, 6, 14, 16, 17, 18, 19, 20, 21, 23, 24, 26, 27, 28, 32, 33, 34], "found": [0, 34], "here": [0, 19, 34], "http": [0, 1, 13, 14, 20, 23, 26, 34], "github": [0, 20], "com": [0, 20], "pytorch": [0, 1, 3, 4, 10, 13, 14, 16, 18, 20, 23, 26, 34], "tnt": [0, 20], "blob": 0, "master": [0, 20], "train_unit_exampl": 0, "py": 0, "less": [0, 34], "code": [0, 1, 2, 6, 10, 19, 34], "more": [0, 1, 14, 23, 25, 26, 34], "featur": 0, "enabl": [0, 1, 34], "out": [0, 2, 33, 34], "box": [0, 2, 33], "auto_unit_exampl": 0, "s": [0, 1, 3, 4, 6, 14, 16, 18, 19, 25, 34], "datapip": 0, "dataloader2": [0, 3, 4, 16, 18], "when": [0, 1, 2, 5, 7, 9, 14, 15, 17, 22, 23, 34], "torchdata_train_exampl": 0, "convnet": 0, "dataset": [0, 15, 22, 24, 27, 28], "main": [0, 14, 20], "class": [1, 2, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 19, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34], "torchtnt": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34], "framework": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19], "arg": [1, 7, 9, 32, 33, 34], "kwarg": [1, 9, 32, 33, 34], "conveni": [1, 6, 19, 34], "user": [1, 10, 14, 17, 19, 23, 33], "who": 1, "ar": [1, 2, 14, 19, 20, 22, 24, 25, 26, 27, 28, 29, 33, 34], "train": [1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 20, 32, 34], "stochast": 1, "gradient": [1, 6], "descent": 1, "would": 1, "like": [1, 26, 34], "have": [1, 14, 34], "optim": [1, 3, 4, 8, 16, 18, 19], "data": [1, 3, 4, 15, 16, 18, 19, 20, 22, 23, 24, 25, 26, 27, 28, 30, 32, 33, 34], "parallel": 1, "replic": [1, 14], "handl": [1, 14, 34], "them": [1, 23], "subclass": [1, 2, 4, 19, 25, 33], "trainunit": [1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 18], "evalunit": [1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 14], "implement": [1, 3, 4, 5, 16, 18, 19, 25, 34], "train_step": [1, 4, 18, 19], "eval_step": [1, 3, 4, 19], "method": [1, 14, 19, 34], "For": [1, 14, 25, 26, 34], "run": [1, 3, 4, 6, 7, 16, 17, 18, 19, 20, 34], "forward": [1, 34], "pass": [1, 2, 25, 29, 32, 34], "loss": [1, 19], "comput": [1, 23], "backward": [1, 19, 34], "step": [1, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 14, 15, 16, 17, 18, 19, 29, 30, 31, 32, 33, 34], "onli": [1, 12, 17, 25, 29, 31, 32, 33, 34], "To": [1, 2, 19, 20, 34], "benefit": 1, "from": [1, 2, 3, 4, 7, 9, 14, 16, 18, 19, 20, 22, 24, 25, 26, 27, 30, 32, 34], "must": [1, 5, 6, 32, 34], "compute_loss": 1, "configure_optimizers_and_lr_schedul": 1, "addition": [1, 34], "offer": [1, 2, 14, 19, 21, 33], "option": [1, 2, 3, 4, 7, 9, 14, 16, 17, 18, 19, 25, 29, 31, 34], "hook": [1, 2, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 19, 34], "on_train_step_end": [1, 2, 4, 6, 7, 10, 12, 14, 18], "on_eval_step_end": [1, 2, 3, 6, 7, 10, 12], "Then": [1, 19], "evalu": [1, 2, 4, 6, 7, 9, 10, 12, 14, 17, 19, 20], "fit": [1, 2, 14, 17, 19, 20], "entri": [1, 2, 14, 17, 34], "point": [1, 2, 6, 17, 19, 34], "normal": 1, "advanc": 1, "custom": [1, 14, 24, 34], "directli": [1, 30], "interfac": [1, 5, 19, 34], "paramet": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18, 19, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 33, 34], "modul": [1, 3, 4, 9, 13, 16, 18, 19, 20, 34], "dure": [1, 2, 3, 4, 5, 7, 14, 16, 17, 18, 34], "devic": [1, 23, 34], "strategi": [1, 28, 34], "string": [1, 5, 30, 32, 33, 34], "one": [1, 5, 19, 24, 28, 34], "ddp": [1, 34], "fsdp": [1, 14, 34], "step_lr_interv": 1, "whether": [1, 11, 17, 34], "lr_schedul": [1, 3, 4, 16, 18, 19], "everi": [1, 6, 11, 15], "epoch": [1, 2, 3, 4, 7, 8, 11, 12, 13, 14, 15, 16, 17, 18, 19, 34], "default": [1, 5, 6, 9, 11, 14, 24, 25, 27, 34], "precis": [1, 34], "either": [1, 8, 11, 13, 15, 34], "torch": [1, 3, 4, 10, 13, 14, 16, 18, 19, 22, 23, 24, 27, 28, 34], "dtype": [1, 34], "gradient_accumulation_step": 1, "mani": 1, "batch": [1, 19, 22, 23, 24, 26, 27, 28, 32, 34], "accumul": 1, "over": [1, 22, 24, 25, 26, 27, 28], "detect_anomali": 1, "anomali": 1, "detect": 1, "autograd": 1, "engin": 1, "org": [1, 13, 14, 23, 26, 34], "doc": [1, 13, 23, 34], "stabl": [1, 13, 23, 34], "html": [1, 13, 14, 23, 26, 34], "clip_grad_norm": 1, "max": [1, 3, 4, 16, 18, 34], "norm": [1, 34], "clip": 1, "gener": [1, 2, 6, 9, 14, 25, 26, 34], "nn": [1, 19, 34], "util": [1, 3, 4, 9, 13, 14, 16, 18, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33], "clip_grad_norm_": 1, "clip_grad_valu": 1, "valu": [1, 22, 24, 25, 26, 27, 28, 30, 32, 33, 34], "clip_grad_value_": 1, "swa_param": 1, "param": [1, 8, 11, 15, 34], "weight": [1, 27], "averag": 1, "torch_compile_param": 1, "compil": 1, "activation_checkpoint_param": 1, "activ": [1, 9, 17, 34], "checkpoint": [1, 2, 14, 34], "true": [1, 14, 29, 31, 33, 34], "lr": 1, "schedul": [1, 8, 19], "creat": [1, 6, 19, 32, 33, 34], "after": [1, 2, 4, 5, 6, 10, 12, 13, 14, 15, 17, 19, 27, 29, 30, 31, 32, 33, 34], "initi": [1, 12, 14, 32, 34], "current": [1, 17, 34], "support": [1, 22, 24, 25, 26, 28, 34], "avail": [1, 14, 34], "2": [1, 22, 23, 24, 27, 28, 34], "0": [1, 12, 14, 22, 24, 27, 28, 29, 31, 32, 33, 34], "higher": 1, "abstract": [1, 19, 20, 21, 33], "state": [1, 2, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 19, 20, 25, 34], "tdata": 1, "tupl": [1, 9, 19, 34], "tensor": [1, 19, 22, 24, 27, 28, 30, 32, 33, 34], "ani": [1, 3, 4, 9, 14, 16, 17, 18, 19, 25, 32, 34], "should": [1, 2, 4, 5, 14, 23, 25, 29, 30, 31, 33, 34], "thi": [1, 2, 4, 5, 6, 14, 15, 19, 22, 23, 24, 25, 27, 28, 32, 34], "call": [1, 2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18, 19, 29, 30, 31, 32, 33, 34], "object": [1, 3, 4, 6, 16, 17, 18, 19, 22, 24, 25, 26, 27, 28, 34], "which": [1, 2, 3, 4, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 23, 25, 34], "return": [1, 14, 19, 22, 24, 25, 27, 28, 34], "contain": [1, 17, 19, 20, 22, 23, 25, 34], "output": [1, 5, 17, 19, 34], "part": 1, "lrschedul": [1, 34], "learn": [1, 8, 19], "rate": [1, 8, 12, 19], "construct": [1, 23, 32, 34], "upon": 1, "A": [1, 2, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 22, 24, 25, 26, 27, 28, 34], "core": [1, 19], "requir": [1, 19, 34], "each": [1, 5, 6, 7, 8, 14, 17, 19, 27, 34], "iter": [1, 3, 4, 11, 15, 16, 17, 18, 19, 22, 23, 24, 25, 26, 27, 28, 34], "eval": [1, 2, 3, 4, 6, 7, 10, 11, 12, 14, 16, 17, 19], "dataload": [1, 3, 4, 7, 14, 16, 17, 18, 19, 22, 23, 24, 25, 26, 27, 28, 34], "wish": [1, 19], "decor": [1, 19], "inference_mod": [1, 19], "improv": [1, 6, 19, 34], "perform": [1, 3, 4, 6, 16, 18, 19], "metadata": [1, 19], "about": [1, 17, 19, 34], "move_data_to_devic": 1, "non_block": 1, "bool": [1, 14, 17, 25, 29, 31, 33, 34], "overrid": 1, "copi": [1, 23, 34], "start": [1, 2, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 17, 19, 34], "By": [1, 5, 6, 14, 24, 27, 34], "function": [1, 2, 7, 9, 19, 25, 26, 34], "copy_data_to_devic": [1, 34], "If": [1, 9, 14, 20, 32, 34], "gpu": [1, 11, 34], "separ": [1, 5, 34], "cuda": [1, 3, 4, 11, 16, 18, 23, 34], "stream": [1, 34], "int": [1, 3, 4, 6, 9, 12, 14, 16, 17, 18, 23, 29, 30, 31, 32, 33, 34], "none": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 25, 29, 30, 31, 32, 33, 34], "end": [1, 2, 5, 6, 7, 10, 12, 13, 14, 15, 17, 19], "befor": [1, 2, 5, 6, 8, 9, 10, 11, 12, 15, 19, 29, 31, 33, 34], "updat": [1, 6, 12, 20], "log": [1, 8, 9, 11, 13, 15, 20, 29, 30, 31, 32, 33, 34], "metric": [1, 20, 32, 33, 34], "do": [1, 20], "anyth": 1, "els": [1, 29, 31, 33], "been": [1, 22, 28, 34], "complet": [1, 14, 17, 34], "on_train_end": [1, 2, 4, 6, 7, 10, 14, 18, 19], "note": [1, 14, 34], "swa": 1, "super": [1, 19], "on_train_epoch_end": [1, 2, 4, 7, 12, 13, 14, 15, 18, 19], "rememb": 1, "autopredictunit": 1, "union": [1, 2, 5, 7, 8, 11, 13, 14, 15, 22, 24, 25, 26, 27, 28, 30, 32, 33, 34], "str": [1, 2, 5, 8, 9, 14, 22, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34], "torchcompileparam": 1, "tpredictdata": [1, 2, 5, 6, 7, 9, 10, 11, 12, 14, 16, 19], "predict_step": [1, 16, 19], "on_predict_step_end": [1, 2, 5, 6, 7, 10, 12, 16], "predict": [1, 2, 5, 6, 7, 9, 10, 11, 12, 17, 19, 20], "an": [2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 16, 18, 19, 23, 25, 34], "extens": 2, "supplement": [2, 14], "your": [2, 19], "loop": [2, 3, 4, 6, 7, 16, 17, 18, 19, 20, 34], "addit": [2, 14, 34], "good": 2, "candid": 2, "logic": [2, 19, 25, 26], "ones": 2, "re": [2, 34], "across": [2, 5, 6, 14, 15, 34], "unit": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18, 20], "intend": [2, 34], "go": 2, "write": [2, 5, 15, 29, 31, 32, 33, 34], "own": [2, 33], "add": [2, 30, 32, 33, 34], "below": [2, 3, 4, 16, 18, 19], "exampl": [2, 3, 4, 7, 16, 18, 19, 22, 23, 24, 25, 26, 27, 28, 30, 32, 34], "print": [2, 7, 9, 11, 22, 24, 27, 28, 34], "messag": [2, 34], "variou": [2, 20], "execut": [2, 3, 4, 6, 16, 17, 18, 34], "import": [2, 3, 4, 6, 7, 16, 18, 19, 30, 32, 34], "tevalunit": 2, "tpredictunit": 2, "ttrainunit": 2, "printingcallback": 2, "def": [2, 7, 19], "on_train_start": [2, 4, 6, 7, 9, 10, 14, 15, 18, 19], "self": [2, 19], "on_eval_start": [2, 3, 6, 7, 9, 10, 19], "on_eval_end": [2, 3, 6, 7, 10, 19], "on_predict_start": [2, 5, 6, 7, 9, 10, 16, 19], "on_predict_end": [2, 5, 6, 7, 10, 16, 19], "instanti": 2, "printing_callback": 2, "train_unit": [2, 18, 19], "train_dataload": [2, 4, 14, 18], "properti": [2, 14, 17, 30, 33, 34], "name": [2, 5, 9, 14, 22, 24, 25, 26, 27, 28, 29, 30, 32, 33, 34], "distinct": 2, "per": [2, 3, 4, 16, 17, 18], "instanc": [2, 3, 4, 13, 16, 17, 18, 25, 34], "debug": [2, 17], "profil": [2, 10, 34], "purpos": 2, "tevaldata": [2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 14, 19], "on_eval_epoch_end": [2, 3, 7, 12, 19], "on_eval_epoch_start": [2, 3, 7, 11, 12, 19], "new": [2, 8, 11, 12, 19, 32], "on_eval_step_start": [2, 3, 7, 11], "on_except": [2, 5, 7, 14], "ttraindata": [2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 18, 19], "predictunit": [2, 5, 6, 7, 9, 10, 11, 12, 14, 16], "exc": [2, 5, 14], "baseexcept": [2, 5, 7, 14, 34], "except": [2, 3, 4, 5, 7, 14, 16, 18, 25, 34], "occur": [2, 5, 7, 14, 15, 34], "on_predict_epoch_end": [2, 7, 12, 16, 19], "on_predict_epoch_start": [2, 7, 11, 12, 16, 19], "on_predict_step_start": [2, 7, 11, 16], "on_train_epoch_start": [2, 4, 7, 8, 11, 12, 18, 19], "on_train_step_start": [2, 4, 7, 8, 11, 18], "we": [2, 6, 21, 23, 33, 34], "sever": [2, 19, 21, 34], "pre": 2, "written": [2, 5, 29, 30, 31, 32, 33], "readi": 2, "eval_unit": [3, 19], "eval_dataload": [3, 4], "max_steps_per_epoch": [3, 16, 17, 18, 34], "callback": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18, 20], "list": [3, 4, 5, 8, 9, 11, 14, 15, 16, 18, 34], "timer": [3, 4, 16, 17, 18, 34], "timerprotocol": [3, 4, 16, 17, 18, 34], "take": [3, 4, 6, 14, 16, 18], "argument": [3, 4, 16, 18, 32, 34], "modifi": [3, 4, 16, 17, 18], "includ": [3, 4, 11, 16, 18, 20, 25, 26, 34], "etc": [3, 4, 9, 16, 18, 25, 26], "number": [3, 4, 6, 12, 14, 16, 17, 18, 23, 29, 31, 33, 34], "mean": [3, 4, 16, 18, 34], "until": [3, 4, 16, 18, 22], "exhaust": [3, 4, 16, 18, 22, 24, 27, 28], "time": [3, 4, 6, 16, 18, 29, 34], "kei": [3, 4, 14, 16, 17, 18, 22, 24, 25, 26, 27, 28, 34], "event": [3, 4, 16, 17, 18, 32, 34], "synchron": [3, 4, 6, 16, 18, 32, 34], "mai": [3, 4, 16, 18, 34], "degrad": [3, 4, 16, 18], "myevalunit": [3, 19], "20": [3, 16], "pseudocod": [3, 4, 16, 18], "what": [3, 4, 16, 18, 34], "doe": [3, 4, 6, 16, 18, 34], "set": [3, 4, 11, 14, 16, 18, 22, 27, 34], "track": [3, 4, 8, 11, 16, 18, 34], "mode": [3, 4, 16, 18, 34], "first": [3, 4, 16, 18, 20], "while": [3, 4, 16, 18, 22, 28, 33], "done": [3, 4, 16, 18, 22, 28, 34], "try": [3, 4, 16, 18], "next": [3, 4, 16, 18, 24], "increment": [3, 4, 16, 18, 34], "counter": [3, 4, 16, 18, 34], "stopiter": [3, 4, 16, 18], "break": [3, 4, 16, 18], "max_epoch": [4, 17, 18], "max_step": [4, 17, 18, 34], "max_train_steps_per_epoch": 4, "max_eval_steps_per_epoch": 4, "evaluate_every_n_step": [4, 17], "evaluate_every_n_epoch": [4, 17], "1": [4, 6, 12, 22, 23, 24, 27, 28, 34], "interleav": [4, 19, 23], "both": 4, "limit": [4, 18], "infinit": [4, 18, 34], "unless": [4, 18], "stop": [4, 17, 18, 22, 27, 28, 34], "often": 4, "term": [4, 15, 17], "fit_unit": 4, "myfitunit": 4, "4": [4, 18, 22, 24, 27, 28, 34], "header_row": 5, "dir_path": 5, "delimit": 5, "t": [5, 34], "filenam": 5, "csv": [5, 29], "file": [5, 29, 31, 32, 33, 34], "provid": [5, 14, 24, 25, 26, 27, 34], "simplifi": [5, 20, 33], "extend": [5, 19], "get_step_output_row": 5, "desir": 5, "row": 5, "all": [5, 6, 9, 14, 22, 24, 26, 27, 29, 31, 33, 34], "process": [5, 6, 14, 32, 34], "same": [5, 6, 14, 19, 24, 25, 26, 34], "match": 5, "column": 5, "defin": [5, 17, 19, 25, 26, 28, 32, 34], "directori": [5, 14, 34], "path": [5, 14, 29, 31, 32, 33, 34], "where": [5, 14, 19, 34], "save": [5, 14, 32, 34], "tab": 5, "step_interv": 6, "period": [6, 14, 34], "garbag": 6, "collect": [6, 11, 14, 32, 34], "In": [6, 19, 34], "fulli": 6, "distribut": [6, 12, 14, 32, 34], "program": [6, 34], "multipl": [6, 30, 32, 33, 34], "These": [6, 19, 34], "need": [6, 19, 34], "commun": [6, 34], "other": [6, 14, 34], "especi": [6, 15], "overal": 6, "therefor": 6, "gate": 6, "slowest": 6, "As": [6, 34], "result": [6, 34], "roughli": 6, "amount": 6, "its": [6, 34], "otherwis": [6, 34], "straggler": 6, "python": [6, 34], "automat": 6, "trigger": 6, "differ": [6, 19, 20, 33, 34], "possibl": 6, "make": [6, 20, 21, 34], "configur": 6, "lead": 6, "frequenc": [6, 14, 17], "tune": 6, "base": [6, 25, 34], "applic": [6, 14, 34], "hand": 6, "free": [6, 34], "up": [6, 17], "some": [6, 19], "reap": 6, "minim": 6, "overhead": 6, "compar": 6, "full": 6, "callabl": [7, 9, 34], "accept": 7, "mydataload": 7, "myunit": [7, 19], "print_on_step_start": 7, "f": [7, 34], "eval_progress": 7, "num_steps_complet": [7, 34], "lambda_cb": 7, "logger": [8, 11, 13, 15, 20, 29, 30, 31, 32, 34], "metriclogg": [8, 11, 15, 33], "logging_interv": [8, 11], "group": [8, 14, 30, 32, 33, 34], "associ": 8, "max_depth": [9, 34], "type": [9, 14, 19, 25, 34], "process_fn": 9, "module_summari": [9, 34], "_log_module_summary_t": 9, "module_input": [9, 34], "mutablemap": [9, 34], "dict": [9, 14, 22, 24, 25, 30, 32, 33, 34], "summari": [9, 32, 34], "maximum": [9, 17, 34], "depth": [9, 34], "keep": [9, 34], "tabl": 9, "map": [9, 22, 24, 26, 27, 28, 30, 32, 33, 34], "want": [9, 14, 19], "flop": [9, 34], "size": [9, 11, 34], "rais": [9, 25, 34], "runtimeerror": [9, 34], "torchev": [9, 34], "instal": 9, "context": [10, 34], "manag": [10, 14, 34], "liter": [11, 34], "system": [11, 34], "stat": [11, 34], "cpu": [11, 34], "usag": 11, "resid": [11, 34], "memori": [11, 23, 30, 34], "experi": 11, "could": 11, "refresh_r": [12, 34], "progress": [12, 14, 15, 34], "bar": 12, "visual": [12, 15, 34], "rank": [12, 14, 29, 31, 32, 33, 34], "environ": [12, 32, 34], "determin": [12, 34], "get": [12, 26, 34], "tensorboardlogg": 13, "summarywrit": [13, 32], "histogram": 13, "tensorboard": [13, 32], "writer": [13, 32], "dirpath": 14, "save_every_n_train_step": 14, "save_every_n_epoch": 14, "storage_opt": 14, "torchsnapshot": 14, "appstatemixin": 14, "random": [14, 34], "also": [14, 20, 25, 26, 33, 34], "under": [14, 19, 34], "epoch_": 14, "_step_": 14, "total": [14, 34], "parent": [14, 17], "snapshot": [14, 34], "intra": 14, "glob": 14, "pattern": 14, "indic": [14, 22, 24, 25, 26, 27, 28, 34], "inform": [14, 17, 34], "see": [14, 34], "api_refer": 14, "keyword": [14, 32, 34], "storag": 14, "plugin": 14, "document": [14, 25, 26], "constructor": 14, "oper": [14, 23, 32, 34], "broadcast": [14, 34], "you": [14, 19, 20, 34], "state_dict": [14, 25, 34], "set_state_dict_typ": 14, "prior": 14, "static": 14, "get_latest_checkpoint_path": 14, "given": [14, 26, 34], "latest": [14, 20], "subdirectori": 14, "valid": 14, "collis": 14, "app": [14, 34], "restor": [14, 34], "restore_train_progress": 14, "restore_eval_progress": 14, "sinc": 14, "There": 14, "flag": 14, "skip": [14, 22, 25, 28], "load": [14, 23, 25, 34], "vs": [15, 34], "help": [15, 21], "begin": [15, 34], "predict_unit": [16, 19], "predict_dataload": 16, "mypredictunit": [16, 19], "entry_point": 17, "entrypoint": 17, "train_stat": 17, "eval_st": 17, "predict_st": 17, "3": [17, 22, 24, 27, 28, 34], "phase": [17, 19], "read": [17, 25, 26], "active_phas": 17, "activephas": 17, "One": 17, "meta": 17, "should_stop": 17, "termin": 17, "signal": [17, 34], "record": [17, 30, 32, 33, 34], "latenc": 17, "step_output": 17, "last": 17, "mytrainunit": [18, 19], "concept": 19, "repres": [19, 34], "primari": 19, "place": 19, "organ": 19, "three": [19, 22], "mutual": 19, "exclus": 19, "e": [19, 34], "g": [19, 34], "case": [19, 34], "allow": [19, 34], "control": [19, 34], "behavior": 19, "simpl": [19, 30, 32], "specifi": [19, 34], "typecheck": 19, "__init__": 19, "_lrschedul": 19, "input": [19, 24, 34], "target": 19, "binary_cross_entropy_with_logit": 19, "zero_grad": 19, "plan": 19, "refer": [19, 25, 26, 34], "my_unit": 19, "librari": [20, 34], "tool": [20, 34], "ha": [20, 22, 25, 26, 28, 34], "two": [20, 28, 34], "compon": 20, "top": 20, "level": 20, "repo": 20, "lightweight": 20, "maintain": 20, "grab": 20, "bag": 20, "independ": 20, "relat": [20, 21, 34], "wrapper": [20, 33, 34], "around": [20, 33, 34], "publish": [20, 33], "pip": 20, "so": 20, "issu": [20, 34], "sure": 20, "version": [20, 34], "just": 20, "git": 20, "upgrad": 20, "autounit": 20, "alldatasetbatchesiter": 20, "cudadataprefetch": 20, "inorderiter": 20, "multidataload": 20, "multiiter": [20, 25], "randomizedbatchsampleriter": [20, 24], "roundrobiniter": 20, "built": 20, "prepar": 21, "easier": 21, "individual_dataload": [22, 24, 25, 26, 27, 28], "iteration_strategi": [22, 24, 25, 26, 27, 28], "alldatasetbatch": 22, "mechan": [22, 27, 28], "all_datasets_exhaust": [22, 27, 28], "finish": 22, "till": [22, 24, 28], "largest": [22, 28], "those": [22, 28], "smallest_dataset_exhaust": [22, 28], "onc": [22, 28, 34], "smallest": [22, 28], "restart_until_all_datasets_exhaust": 22, "restart": 22, "format": [22, 24, 27, 28], "dataloader_1_nam": 22, "batch_obtained_from_dataloader_1": 22, "dataloader_2_nam": 22, "batch_obtained_from_dataloader_2": 22, "dataclass": [22, 24, 25, 26, 27, 28, 34], "loader": [22, 24, 27, 28], "rang": [22, 24, 27, 28, 34], "batch_siz": [22, 24, 27, 28], "b": [22, 24, 27, 28], "15": [22, 24, 27, 28], "5": [22, 24, 27, 28, 34], "all_dataset_batch_strategi": 22, "stopping_mechan": [22, 27, 28], "stoppingmechan": [22, 27, 28], "combined_iter": [22, 24, 27, 28], "item": [22, 24, 27, 28], "6": [22, 24, 27, 28], "7": [22, 24, 27, 28], "8": [22, 24, 27, 28, 34], "9": [22, 24, 27, 28], "10": [22, 24, 27, 28, 30, 32], "11": [22, 24, 27, 28], "12": [22, 24, 27, 28, 34], "13": [22, 24, 27, 28, 34], "14": [22, 24, 27, 28], "data_iter": 23, "num_prefetch_batch": 23, "prefetch": 23, "move": [23, 24, 34], "host": [23, 34], "effect": 23, "recommend": 23, "leverag": 23, "pin": 23, "data_prefetch": 23, "alreadi": [23, 34], "inord": 24, "singl": [24, 34], "order": [24, 26, 28, 34], "overridden": 24, "repetit": 24, "dataloader_nam": [24, 27, 28], "batch_from_dataload": [24, 27, 28], "randomizedbatchsampl": [24, 27], "in_order_strategi": 24, "dataiterationstrategi": [25, 26], "iterator_cl": 25, "ignore_empty_data": 25, "fals": [25, 29, 31, 34], "cycl": [25, 26, 28], "through": 25, "individu": [25, 26], "dictionari": [25, 30, 32, 33], "torchdata": [25, 26], "multi": [25, 26], "sourc": [25, 26, 34], "achiev": [25, 26], "mux": [25, 26], "mux_longest": [25, 26], "zip": [25, 26], "pleas": [25, 26, 34], "detail": [25, 26, 34], "load_state_dict": [25, 34], "aggreg": 25, "off": 25, "protocol": [25, 34], "accompani": 26, "particular": 26, "beta": 26, "index": [26, 34], "randomli": 27, "sampl": 27, "chang": [27, 34], "anoth": 27, "randomized_batch_sampl": 27, "roundrobin": 28, "via": 28, "robinrobin": 28, "round_robin_strategi": 28, "steps_before_flush": [29, 31, 33], "100": [29, 31], "log_all_rank": [29, 31, 33], "header": 29, "buffer": [29, 30], "flush": [29, 30, 31, 32, 33], "close": [29, 30, 31, 32, 33], "resourc": [29, 30, 31, 33], "necessari": [29, 30, 31, 33], "accuraci": [30, 32], "23": [30, 32], "56": [30, 32], "ndarrai": [30, 32, 33], "float": [30, 32, 33, 34], "scalar": [30, 32, 33], "uniqu": [30, 33], "log_buff": 30, "access": 30, "log_dict": [30, 32, 33], "payload": [30, 32, 33], "tag": [30, 32, 33], "json": 31, "store": [31, 33, 34], "On": 32, "variabl": [32, 34], "extra": 32, "posit": [32, 34], "tmp": 32, "tb_log": 32, "pend": 32, "disk": 32, "cannot": 32, "log_audio": 32, "audio": 32, "add_audio": 32, "log_hparam": 32, "hparam": 32, "hyperparamet": 32, "correspond": [32, 34], "log_imag": 32, "imag": 32, "add_imag": 32, "log_text": 32, "text": 32, "identifi": 32, "filelogg": 33, "abov": 33, "follow": [33, 34], "cpustat": 34, "cpu_perc": 34, "cpu_swap_perc": 34, "cpu_vm_perc": 34, "worker_cpu_time_system": 34, "worker_cpu_time_us": 34, "worker_rss": 34, "ddpstrategi": 34, "output_devic": 34, "dim": 34, "broadcast_buff": 34, "process_group": 34, "processgroup": 34, "bucket_cap_mb": 34, "25": 34, "find_unused_paramet": 34, "check_reduct": 34, "gradient_as_bucket_view": 34, "static_graph": 34, "comm_stat": 34, "comm_hook": 34, "gradbucket": 34, "futur": 34, "sync_batchnorm": 34, "distributeddataparallel": 34, "regist": 34, "sync": 34, "earlystopcheck": 34, "min": 34, "patienc": 34, "min_delta": 34, "check_finit": 34, "threshold_mod": 34, "ab": 34, "rel": 34, "stopping_threshold": 34, "divergence_threshold": 34, "monitor": 34, "earli": 34, "decreas": 34, "increas": 34, "check": 34, "without": 34, "minimum": 34, "absolut": 34, "qualifi": 34, "improvement_threshold": 34, "best_val": 34, "threshold": 34, "becom": 34, "nan": 34, "delta": 34, "between": 34, "beyond": 34, "wors": 34, "than": 34, "valueerror": 34, "val": 34, "element": 34, "boolean": 34, "reset": 34, "back": 34, "reload": 34, "fsdpstrategi": 34, "sharding_strategi": 34, "shardingstrategi": 34, "cpu_offload": 34, "cpuoffload": 34, "auto_wrap_polici": 34, "backward_prefetch": 34, "backwardprefetch": 34, "backward_pr": 34, "ignored_modul": 34, "sync_module_st": 34, "forward_prefetch": 34, "limit_all_gath": 34, "use_orig_param": 34, "state_dict_typ": 34, "statedicttyp": 34, "state_dict_config": 34, "statedictconfig": 34, "optim_state_dict_config": 34, "optimstatedictconfig": 34, "fullyshardeddataparallel": 34, "floptensordispatchmod": 34, "measur": 34, "count": 34, "dev": 34, "discuss": 34, "ideal": 34, "dispatch": 34, "505": 34, "torchvis": 34, "resnet18": 34, "randn": 34, "224": 34, "ftdm": 34, "flops_forward": 34, "deepcopi": 34, "flop_count": 34, "flops_backward": 34, "fullsyncperiodictim": 34, "interv": 34, "timedelta": 34, "cpu_pg": 34, "elaps": 34, "propag": 34, "asynchron": 34, "previou": 34, "avoid": 34, "block": 34, "gpustat": 34, "fan_speed_perc": 34, "memory_free_mb": 34, "memory_used_mb": 34, "temperature_gpu_celsiu": 34, "temperature_memory_celsiu": 34, "utilization_gpu_perc": 34, "utilization_memory_perc": 34, "modulesummari": 34, "submodul": 34, "trainabl": 34, "estim": 34, "byte": 34, "uniniti": 34, "calcul": 34, "shape": 34, "ms": 34, "forward_elapsed_time_m": 34, "has_uninitialized_param": 34, "in_siz": 34, "module_nam": 34, "module_typ": 34, "num_paramet": 34, "num_trainable_paramet": 34, "requires_grad": 34, "out_siz": 34, "size_byt": 34, "submodule_summari": 34, "travers": 34, "pgwrapper": 34, "pg": 34, "consist": 34, "fashion": 34, "regardless": 34, "scenario": 34, "world": 34, "all_gather_object": 34, "obj_list": 34, "obj": 34, "barrier": 34, "broadcast_object_list": 34, "src": 34, "get_rank": 34, "get_world_s": 34, "scatter_object_list": 34, "output_list": 34, "input_list": 34, "num_epochs_complet": 34, "num_steps_completed_in_epoch": 34, "increment_epoch": 34, "within": 34, "increment_step": 34, "accord": 34, "thu": 34, "far": 34, "rssprofil": 34, "datetim": 34, "microsecond": 34, "100000": 34, "rss": 34, "baselin": 34, "rss_deltas_byt": 34, "100m": 34, "round": 34, "captur": 34, "thread": 34, "empti": 34, "tlrschedul": 34, "alia": 34, "cuda_sync": 34, "verbos": 34, "recorded_dur": 34, "action_nam": 34, "enclos": 34, "all_gather_tensor": 34, "gather": 34, "onto": 34, "work": 34, "dimens": 34, "pad": 34, "trim": 34, "secur": 34, "equal": 34, "workload": 34, "gathered_result": 34, "i": 34, "attach_oom_observ": 34, "output_dir": 34, "trace_max_entri": 34, "1000000": 34, "attach": 34, "error": 34, "blog": 34, "post": 34, "trace": 34, "invok": 34, "global": 34, "granular": 34, "wrap": 34, "close_progress_bar": 34, "progress_bar": 34, "tqdm_asyncio": 34, "recurs": 34, "correct": 34, "create_progress_bar": 34, "desc": 34, "days_to_sec": 34, "dai": 34, "convert": 34, "second": 34, "get_device_from_env": 34, "reli": 34, "local_rank": 34, "made": 34, "launcher": 34, "appropri": 34, "outsid": 34, "get_filesystem": 34, "abstractfilesystem": 34, "filesystem": 34, "get_global_rank": 34, "env": 34, "var": 34, "instead": 34, "neither": 34, "condit": 34, "met": 34, "get_local_rank": 34, "popul": 34, "elast": 34, "get_module_summari": 34, "module_arg": 34, "module_kwarg": 34, "assign": 34, "tree": 34, "summar": 34, "greater": 34, "lazi": 34, "NOT": 34, "todo": 34, "flexibl": 34, "get_nvidia_smi_gpu_stat": 34, "nvidia": 34, "smi": 34, "filenotfounderror": 34, "command": 34, "get_process_group_backend_from_devic": 34, "backend": 34, "get_psutil_cpu_stat": 34, "psutil": 34, "get_python_vers": 34, "runtim": 34, "get_summary_t": 34, "human_readable_num": 34, "summary_t": 34, "tabular": 34, "exact": 34, "1234": 34, "k": 34, "get_tensor_size_bytes_map": 34, "get_timer_summari": 34, "action": 34, "get_torch_vers": 34, "world_siz": 34, "init_from_env": 34, "device_typ": 34, "dist_init_method_typ": 34, "tcp": 34, "pg_backend": 34, "pg_timeout": 34, "1800": 34, "float32_matmul_precis": 34, "high": 34, "launch": 34, "script": 34, "spmd": 34, "style": 34, "timeout": 34, "against": 34, "30": 34, "minut": 34, "matrix": 34, "is_out_of_cpu_memori": 34, "oom": 34, "is_out_of_cuda_memori": 34, "is_out_of_memory_error": 34, "due": 34, "is_torch_version_ge_1_13_1": 34, "is_torch_version_geq_1_10": 34, "is_torch_version_geq_1_11": 34, "is_torch_version_geq_1_12": 34, "is_torch_version_geq_1_13": 34, "is_torch_version_geq_1_14": 34, "is_torch_version_geq_1_8": 34, "is_torch_version_geq_1_9": 34, "is_torch_version_geq_2_0": 34, "is_window": 34, "Is": 34, "window": 34, "log_elapsed_tim": 34, "being": 34, "most": 34, "accur": 34, "log_memory_snapshot": 34, "maybe_enable_tf32": 34, "condition": 34, "float32": 34, "datatyp": 34, "measure_rss_delta": 34, "rss_delta": 34, "append": 34, "prepare_ddp": 34, "api": 34, "linear": 34, "ddp_modul": 34, "prepare_fsdp": 34, "fsdp_modul": 34, "prune_module_summari": 34, "prune": 34, "deeper": 34, "prun": 34, "inplac": 34, "root": 34, "rank_zero_crit": 34, "rank_zero_debug": 34, "rank_zero_error": 34, "rank_zero_info": 34, "rank_zero_print": 34, "rank_zero_warn": 34, "record_data_in_stream": 34, "mention": 34, "record_stream": 34, "cach": 34, "alloc": 34, "freed": 34, "reus": 34, "newli": 34, "still": 34, "wa": 34, "tell": 34, "might": 34, "underli": 34, "longer": 34, "creator": 34, "notabl": 34, "trick": 34, "seed": 34, "determinist": 34, "pseudo": 34, "commonli": 34, "numpi": 34, "integ": 34, "don": 34, "warn": 34, "nondeterminist": 34, "cudnn": 34, "benchmark": 34, "disabl": 34, "set_deterministic_debug_mod": 34, "algorithm": 34, "sync_bool": 34, "coherence_mod": 34, "rank_zero": 34, "member": 34, "manner": 34, "receiv": 34, "truth": 34, "n": 34, "least": 34, "ratio": 34, "synced_v": 34, "iff": 34, "success": 34, "transfer_batch_norm_stat": 34, "src_modul": 34, "dst_modul": 34, "transfer": 34, "statist": 34, "transfer_weight": 34, "update_progress_bar": 34}, "objects": {"torchtnt.framework": [[1, 0, 1, "", "AutoPredictUnit"], [1, 0, 1, "", "AutoUnit"], [19, 0, 1, "", "EvalUnit"], [17, 0, 1, "", "PhaseState"], [19, 0, 1, "", "PredictUnit"], [17, 0, 1, "", "State"], [19, 0, 1, "", "TrainUnit"], [2, 3, 0, "-", "callback"], [3, 4, 1, "", "evaluate"], [4, 4, 1, "", "fit"], [16, 4, 1, "", "predict"], [18, 4, 1, "", "train"]], "torchtnt.framework.AutoPredictUnit": [[1, 1, 1, "", "move_data_to_device"], [1, 1, 1, "", "on_predict_step_end"], [1, 1, 1, "", "predict_step"]], "torchtnt.framework.AutoUnit": [[1, 1, 1, "", "compute_loss"], [1, 1, 1, "", "configure_optimizers_and_lr_scheduler"], [1, 1, 1, "", "eval_step"], [1, 1, 1, "", "move_data_to_device"], [1, 1, 1, "", "on_eval_step_end"], [1, 1, 1, "", "on_train_end"], [1, 1, 1, "", "on_train_epoch_end"], [1, 1, 1, "", "on_train_step_end"], [1, 1, 1, "", "train_step"]], "torchtnt.framework.EvalUnit": [[19, 1, 1, "", "eval_step"], [19, 1, 1, "", "on_eval_end"], [19, 1, 1, "", "on_eval_epoch_end"], [19, 1, 1, "", "on_eval_epoch_start"], [19, 1, 1, "", "on_eval_start"]], "torchtnt.framework.PhaseState": [[17, 2, 1, "", "dataloader"], [17, 2, 1, "", "evaluate_every_n_epochs"], [17, 2, 1, "", "evaluate_every_n_steps"], [17, 2, 1, "", "max_epochs"], [17, 2, 1, "", "max_steps"], [17, 2, 1, "", "max_steps_per_epoch"], [17, 2, 1, "", "step_output"]], "torchtnt.framework.PredictUnit": [[19, 1, 1, "", "on_predict_end"], [19, 1, 1, "", "on_predict_epoch_end"], [19, 1, 1, "", "on_predict_epoch_start"], [19, 1, 1, "", "on_predict_start"], [19, 1, 1, "", "predict_step"]], "torchtnt.framework.State": [[17, 2, 1, "", "active_phase"], [17, 2, 1, "", "entry_point"], [17, 2, 1, "", "eval_state"], [17, 2, 1, "", "predict_state"], [17, 2, 1, "", "should_stop"], [17, 1, 1, "", "stop"], [17, 2, 1, "", "timer"], [17, 2, 1, "", "train_state"]], "torchtnt.framework.TrainUnit": [[19, 1, 1, "", "on_train_end"], [19, 1, 1, "", "on_train_epoch_end"], [19, 1, 1, "", "on_train_epoch_start"], [19, 1, 1, "", "on_train_start"], [19, 1, 1, "", "train_step"]], "torchtnt.framework.callback": [[2, 0, 1, "", "Callback"]], "torchtnt.framework.callback.Callback": [[2, 2, 1, "", "name"], [2, 1, 1, "", "on_eval_end"], [2, 1, 1, "", "on_eval_epoch_end"], [2, 1, 1, "", "on_eval_epoch_start"], [2, 1, 1, "", "on_eval_start"], [2, 1, 1, "", "on_eval_step_end"], [2, 1, 1, "", "on_eval_step_start"], [2, 1, 1, "", "on_exception"], [2, 1, 1, "", "on_predict_end"], [2, 1, 1, "", "on_predict_epoch_end"], [2, 1, 1, "", "on_predict_epoch_start"], [2, 1, 1, "", "on_predict_start"], [2, 1, 1, "", "on_predict_step_end"], [2, 1, 1, "", "on_predict_step_start"], [2, 1, 1, "", "on_train_end"], [2, 1, 1, "", "on_train_epoch_end"], [2, 1, 1, "", "on_train_epoch_start"], [2, 1, 1, "", "on_train_start"], [2, 1, 1, "", "on_train_step_end"], [2, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks": [[5, 0, 1, "", "BaseCSVWriter"], [6, 0, 1, "", "GarbageCollector"], [7, 0, 1, "", "Lambda"], [8, 0, 1, "", "LearningRateMonitor"], [9, 0, 1, "", "ModuleSummary"], [10, 0, 1, "", "PyTorchProfiler"], [11, 0, 1, "", "SystemResourcesMonitor"], [12, 0, 1, "", "TQDMProgressBar"], [13, 0, 1, "", "TensorBoardParameterMonitor"], [14, 0, 1, "", "TorchSnapshotSaver"], [15, 0, 1, "", "TrainProgressMonitor"]], "torchtnt.framework.callbacks.BaseCSVWriter": [[5, 1, 1, "", "on_exception"], [5, 1, 1, "", "on_predict_end"], [5, 1, 1, "", "on_predict_start"], [5, 1, 1, "", "on_predict_step_end"]], "torchtnt.framework.callbacks.GarbageCollector": [[6, 1, 1, "", "on_eval_end"], [6, 1, 1, "", "on_eval_start"], [6, 1, 1, "", "on_eval_step_end"], [6, 1, 1, "", "on_predict_end"], [6, 1, 1, "", "on_predict_start"], [6, 1, 1, "", "on_predict_step_end"], [6, 1, 1, "", "on_train_end"], [6, 1, 1, "", "on_train_start"], [6, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.LearningRateMonitor": [[8, 1, 1, "", "on_train_epoch_start"], [8, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks.ModuleSummary": [[9, 1, 1, "", "on_eval_start"], [9, 1, 1, "", "on_predict_start"], [9, 1, 1, "", "on_train_start"]], "torchtnt.framework.callbacks.PyTorchProfiler": [[10, 1, 1, "", "on_eval_end"], [10, 1, 1, "", "on_eval_start"], [10, 1, 1, "", "on_eval_step_end"], [10, 1, 1, "", "on_predict_end"], [10, 1, 1, "", "on_predict_start"], [10, 1, 1, "", "on_predict_step_end"], [10, 1, 1, "", "on_train_end"], [10, 1, 1, "", "on_train_start"], [10, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.SystemResourcesMonitor": [[11, 1, 1, "", "on_eval_epoch_start"], [11, 1, 1, "", "on_eval_step_start"], [11, 1, 1, "", "on_predict_epoch_start"], [11, 1, 1, "", "on_predict_step_start"], [11, 1, 1, "", "on_train_epoch_start"], [11, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks.TQDMProgressBar": [[12, 1, 1, "", "on_eval_epoch_end"], [12, 1, 1, "", "on_eval_epoch_start"], [12, 1, 1, "", "on_eval_step_end"], [12, 1, 1, "", "on_predict_epoch_end"], [12, 1, 1, "", "on_predict_epoch_start"], [12, 1, 1, "", "on_predict_step_end"], [12, 1, 1, "", "on_train_epoch_end"], [12, 1, 1, "", "on_train_epoch_start"], [12, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.TensorBoardParameterMonitor": [[13, 1, 1, "", "on_train_epoch_end"]], "torchtnt.framework.callbacks.TorchSnapshotSaver": [[14, 2, 1, "", "dirpath"], [14, 1, 1, "", "get_latest_checkpoint_path"], [14, 1, 1, "", "on_exception"], [14, 1, 1, "", "on_train_end"], [14, 1, 1, "", "on_train_epoch_end"], [14, 1, 1, "", "on_train_start"], [14, 1, 1, "", "on_train_step_end"], [14, 1, 1, "", "restore"]], "torchtnt.framework.callbacks.TrainProgressMonitor": [[15, 1, 1, "", "on_train_epoch_end"], [15, 1, 1, "", "on_train_start"]], "torchtnt": [[34, 3, 0, "-", "utils"]], "torchtnt.utils": [[34, 0, 1, "", "CPUStats"], [34, 0, 1, "", "DDPStrategy"], [34, 0, 1, "", "EarlyStopChecker"], [34, 0, 1, "", "FSDPStrategy"], [34, 0, 1, "", "FlopTensorDispatchMode"], [34, 0, 1, "", "FullSyncPeriodicTimer"], [34, 0, 1, "", "GPUStats"], [34, 0, 1, "", "ModuleSummary"], [34, 0, 1, "", "PGWrapper"], [34, 0, 1, "", "Progress"], [34, 0, 1, "", "RSSProfiler"], [34, 0, 1, "", "Stateful"], [34, 5, 1, "", "TLRScheduler"], [34, 0, 1, "", "Timer"], [34, 4, 1, "", "all_gather_tensors"], [34, 4, 1, "", "attach_oom_observer"], [34, 4, 1, "", "barrier"], [34, 4, 1, "", "close_progress_bar"], [34, 4, 1, "", "copy_data_to_device"], [34, 4, 1, "", "create_progress_bar"], [21, 3, 0, "-", "data"], [34, 4, 1, "", "days_to_secs"], [34, 4, 1, "", "get_device_from_env"], [34, 4, 1, "", "get_filesystem"], [34, 4, 1, "", "get_global_rank"], [34, 4, 1, "", "get_local_rank"], [34, 4, 1, "", "get_module_summary"], [34, 4, 1, "", "get_nvidia_smi_gpu_stats"], [34, 4, 1, "", "get_process_group_backend_from_device"], [34, 4, 1, "", "get_psutil_cpu_stats"], [34, 4, 1, "", "get_python_version"], [34, 4, 1, "", "get_summary_table"], [34, 4, 1, "", "get_tensor_size_bytes_map"], [34, 4, 1, "", "get_timer_summary"], [34, 4, 1, "", "get_torch_version"], [34, 4, 1, "", "get_world_size"], [34, 4, 1, "", "init_from_env"], [34, 4, 1, "", "is_out_of_cpu_memory"], [34, 4, 1, "", "is_out_of_cuda_memory"], [34, 4, 1, "", "is_out_of_memory_error"], [34, 4, 1, "", "is_torch_version_ge_1_13_1"], [34, 4, 1, "", "is_torch_version_geq_1_10"], [34, 4, 1, "", "is_torch_version_geq_1_11"], [34, 4, 1, "", "is_torch_version_geq_1_12"], [34, 4, 1, "", "is_torch_version_geq_1_13"], [34, 4, 1, "", "is_torch_version_geq_1_14"], [34, 4, 1, "", "is_torch_version_geq_1_8"], [34, 4, 1, "", "is_torch_version_geq_1_9"], [34, 4, 1, "", "is_torch_version_geq_2_0"], [34, 4, 1, "", "is_windows"], [34, 4, 1, "", "log_elapsed_time"], [34, 4, 1, "", "log_memory_snapshot"], [33, 3, 0, "-", "loggers"], [34, 4, 1, "", "maybe_enable_tf32"], [34, 4, 1, "", "measure_rss_deltas"], [34, 4, 1, "", "prepare_ddp"], [34, 4, 1, "", "prepare_fsdp"], [34, 4, 1, "", "prune_module_summary"], [34, 4, 1, "", "rank_zero_critical"], [34, 4, 1, "", "rank_zero_debug"], [34, 4, 1, "", "rank_zero_error"], [34, 4, 1, "", "rank_zero_info"], [34, 4, 1, "", "rank_zero_print"], [34, 4, 1, "", "rank_zero_warn"], [34, 4, 1, "", "record_data_in_stream"], [34, 4, 1, "", "seed"], [34, 4, 1, "", "sync_bool"], [34, 4, 1, "", "transfer_batch_norm_stats"], [34, 4, 1, "", "transfer_weights"], [34, 4, 1, "", "update_progress_bar"]], "torchtnt.utils.CPUStats": [[34, 5, 1, "", "cpu_percent"], [34, 5, 1, "", "cpu_swap_percent"], [34, 5, 1, "", "cpu_vm_percent"], [34, 5, 1, "", "worker_cpu_time_system"], [34, 5, 1, "", "worker_cpu_time_user"], [34, 5, 1, "", "worker_rss"]], "torchtnt.utils.DDPStrategy": [[34, 5, 1, "", "broadcast_buffers"], [34, 5, 1, "", "bucket_cap_mb"], [34, 5, 1, "", "check_reduction"], [34, 5, 1, "", "comm_hook"], [34, 5, 1, "", "comm_state"], [34, 5, 1, "", "dim"], [34, 5, 1, "", "find_unused_parameters"], [34, 5, 1, "", "gradient_as_bucket_view"], [34, 5, 1, "", "output_device"], [34, 5, 1, "", "process_group"], [34, 5, 1, "", "static_graph"], [34, 5, 1, "", "sync_batchnorm"]], "torchtnt.utils.EarlyStopChecker": [[34, 1, 1, "", "check"], [34, 2, 1, "", "check_finite"], [34, 2, 1, "", "divergence_threshold"], [34, 1, 1, "", "load_state_dict"], [34, 2, 1, "", "min_delta"], [34, 2, 1, "", "mode"], [34, 2, 1, "", "patience"], [34, 1, 1, "", "reset"], [34, 1, 1, "", "state_dict"], [34, 2, 1, "", "stopping_threshold"], [34, 2, 1, "", "threshold_mode"]], "torchtnt.utils.FSDPStrategy": [[34, 5, 1, "", "auto_wrap_policy"], [34, 5, 1, "", "backward_prefetch"], [34, 5, 1, "", "cpu_offload"], [34, 5, 1, "", "forward_prefetch"], [34, 5, 1, "", "ignored_modules"], [34, 5, 1, "", "limit_all_gathers"], [34, 5, 1, "", "optim_state_dict_config"], [34, 5, 1, "", "process_group"], [34, 5, 1, "", "sharding_strategy"], [34, 5, 1, "", "state_dict_config"], [34, 5, 1, "", "state_dict_type"], [34, 5, 1, "", "sync_module_states"], [34, 5, 1, "", "use_orig_params"]], "torchtnt.utils.FlopTensorDispatchMode": [[34, 1, 1, "", "reset"]], "torchtnt.utils.FullSyncPeriodicTimer": [[34, 1, 1, "", "check"]], "torchtnt.utils.GPUStats": [[34, 5, 1, "", "fan_speed_percent"], [34, 5, 1, "", "memory_free_mb"], [34, 5, 1, "", "memory_used_mb"], [34, 5, 1, "", "temperature_gpu_celsius"], [34, 5, 1, "", "temperature_memory_celsius"], [34, 5, 1, "", "utilization_gpu_percent"], [34, 5, 1, "", "utilization_memory_percent"]], "torchtnt.utils.ModuleSummary": [[34, 2, 1, "", "flops_backward"], [34, 2, 1, "", "flops_forward"], [34, 2, 1, "", "forward_elapsed_time_ms"], [34, 2, 1, "", "has_uninitialized_param"], [34, 2, 1, "", "in_size"], [34, 2, 1, "", "module_name"], [34, 2, 1, "", "module_type"], [34, 2, 1, "", "num_parameters"], [34, 2, 1, "", "num_trainable_parameters"], [34, 2, 1, "", "out_size"], [34, 2, 1, "", "size_bytes"], [34, 2, 1, "", "submodule_summaries"]], "torchtnt.utils.PGWrapper": [[34, 1, 1, "", "all_gather_object"], [34, 1, 1, "", "barrier"], [34, 1, 1, "", "broadcast_object_list"], [34, 1, 1, "", "get_rank"], [34, 1, 1, "", "get_world_size"], [34, 1, 1, "", "scatter_object_list"]], "torchtnt.utils.Progress": [[34, 1, 1, "", "increment_epoch"], [34, 1, 1, "", "increment_step"], [34, 1, 1, "", "load_state_dict"], [34, 2, 1, "", "num_epochs_completed"], [34, 2, 1, "", "num_steps_completed"], [34, 2, 1, "", "num_steps_completed_in_epoch"], [34, 1, 1, "", "state_dict"]], "torchtnt.utils.RSSProfiler": [[34, 5, 1, "", "interval"], [34, 1, 1, "", "profile"], [34, 1, 1, "", "reset"], [34, 5, 1, "", "rss_deltas_bytes"]], "torchtnt.utils.Stateful": [[34, 1, 1, "", "load_state_dict"], [34, 1, 1, "", "state_dict"]], "torchtnt.utils.Timer": [[34, 1, 1, "", "reset"], [34, 1, 1, "", "time"]], "torchtnt.utils.data": [[22, 0, 1, "", "AllDatasetBatchesIterator"], [23, 0, 1, "", "CudaDataPrefetcher"], [24, 0, 1, "", "InOrderIterator"], [25, 0, 1, "", "MultiDataLoader"], [26, 0, 1, "", "MultiIterator"], [27, 0, 1, "", "RandomizedBatchSamplerIterator"], [28, 0, 1, "", "RoundRobinIterator"]], "torchtnt.utils.data.MultiDataLoader": [[25, 5, 1, "", "ignore_empty_data"], [25, 5, 1, "", "individual_dataloaders"], [25, 5, 1, "", "iteration_strategy"], [25, 5, 1, "", "iterator_cls"], [25, 1, 1, "", "load_state_dict"], [25, 1, 1, "", "state_dict"]], "torchtnt.utils.loggers": [[29, 0, 1, "", "CSVLogger"], [33, 0, 1, "", "FileLogger"], [30, 0, 1, "", "InMemoryLogger"], [31, 0, 1, "", "JSONLogger"], [33, 0, 1, "", "MetricLogger"], [32, 0, 1, "", "TensorBoardLogger"]], "torchtnt.utils.loggers.CSVLogger": [[29, 1, 1, "", "close"]], "torchtnt.utils.loggers.FileLogger": [[33, 1, 1, "", "close"], [33, 1, 1, "", "flush"], [33, 1, 1, "", "log"], [33, 1, 1, "", "log_dict"], [33, 2, 1, "", "path"]], "torchtnt.utils.loggers.InMemoryLogger": [[30, 1, 1, "", "close"], [30, 1, 1, "", "log"], [30, 2, 1, "", "log_buffer"], [30, 1, 1, "", "log_dict"]], "torchtnt.utils.loggers.JSONLogger": [[31, 1, 1, "", "close"]], "torchtnt.utils.loggers.MetricLogger": [[33, 1, 1, "", "close"], [33, 1, 1, "", "log"], [33, 1, 1, "", "log_dict"]], "torchtnt.utils.loggers.TensorBoardLogger": [[32, 1, 1, "", "close"], [32, 1, 1, "", "flush"], [32, 1, 1, "", "log"], [32, 1, 1, "", "log_audio"], [32, 1, 1, "", "log_dict"], [32, 1, 1, "", "log_hparams"], [32, 1, 1, "", "log_image"], [32, 1, 1, "", "log_images"], [32, 1, 1, "", "log_text"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:property", "3": "py:module", "4": "py:function", "5": "py:attribute"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "property", "Python property"], "3": ["py", "module", "Python module"], "4": ["py", "function", "Python function"], "5": ["py", "attribute", "Python attribute"]}, "titleterms": {"exampl": [0, 20], "trainunit": [0, 19], "autounit": [0, 1], "torchdata": 0, "train": [0, 18], "mnist": 0, "mingpt": 0, "torchrec": 0, "callback": 2, "built": [2, 33], "evalu": 3, "entri": [3, 4, 16, 18], "point": [3, 4, 16, 18], "fit": 4, "basecsvwrit": 5, "garbagecollector": 6, "lambda": 7, "learningratemonitor": 8, "modulesummari": 9, "pytorchprofil": 10, "systemresourcesmonitor": 11, "tqdmprogressbar": 12, "tensorboardparametermonitor": 13, "torchsnapshotsav": 14, "trainprogressmonitor": 15, "predict": 16, "state": 17, "phasest": 17, "unit": 19, "evalunit": 19, "predictunit": 19, "combin": 19, "multipl": 19, "welcom": 20, "torchtnt": 20, "document": 20, "instal": 20, "framework": 20, "util": [20, 34], "data": 21, "alldatasetbatchesiter": 22, "cudadataprefetch": 23, "inorderiter": 24, "multidataload": 25, "multiiter": 26, "randomizedbatchsampleriter": 27, "roundrobiniter": 28, "csvlogger": 29, "inmemorylogg": 30, "jsonlogg": 31, "tensorboardlogg": 32, "logger": 33}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 56}})