Search.setIndex({"docnames": ["checkpointing", "distributed", "examples", "framework/auto_unit", "framework/callbacks", "framework/eval", "framework/fit", "framework/generated/torchtnt.framework.callbacks.BaseCSVWriter", "framework/generated/torchtnt.framework.callbacks.GarbageCollector", "framework/generated/torchtnt.framework.callbacks.IterationTimeLogger", "framework/generated/torchtnt.framework.callbacks.Lambda", "framework/generated/torchtnt.framework.callbacks.LearningRateMonitor", "framework/generated/torchtnt.framework.callbacks.ModuleSummary", "framework/generated/torchtnt.framework.callbacks.PyTorchProfiler", "framework/generated/torchtnt.framework.callbacks.SystemResourcesMonitor", "framework/generated/torchtnt.framework.callbacks.TQDMProgressBar", "framework/generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor", "framework/generated/torchtnt.framework.callbacks.TorchSnapshotSaver", "framework/generated/torchtnt.framework.callbacks.TrainProgressMonitor", "framework/predict", "framework/state", "framework/train", "framework/unit", "index", "utils/data", "utils/generated/torchtnt.utils.data.AllDatasetBatchesIterator", "utils/generated/torchtnt.utils.data.CudaDataPrefetcher", "utils/generated/torchtnt.utils.data.InOrderIterator", "utils/generated/torchtnt.utils.data.MultiDataLoader", "utils/generated/torchtnt.utils.data.MultiIterator", "utils/generated/torchtnt.utils.data.RandomizedBatchSamplerIterator", "utils/generated/torchtnt.utils.data.RoundRobinIterator", "utils/generated/torchtnt.utils.loggers.CSVLogger", "utils/generated/torchtnt.utils.loggers.InMemoryLogger", "utils/generated/torchtnt.utils.loggers.JSONLogger", "utils/generated/torchtnt.utils.loggers.TensorBoardLogger", "utils/loggers", "utils/utils"], "filenames": ["checkpointing.rst", "distributed.rst", "examples.rst", "framework/auto_unit.rst", "framework/callbacks.rst", "framework/eval.rst", "framework/fit.rst", "framework/generated/torchtnt.framework.callbacks.BaseCSVWriter.rst", "framework/generated/torchtnt.framework.callbacks.GarbageCollector.rst", "framework/generated/torchtnt.framework.callbacks.IterationTimeLogger.rst", "framework/generated/torchtnt.framework.callbacks.Lambda.rst", "framework/generated/torchtnt.framework.callbacks.LearningRateMonitor.rst", "framework/generated/torchtnt.framework.callbacks.ModuleSummary.rst", "framework/generated/torchtnt.framework.callbacks.PyTorchProfiler.rst", "framework/generated/torchtnt.framework.callbacks.SystemResourcesMonitor.rst", "framework/generated/torchtnt.framework.callbacks.TQDMProgressBar.rst", "framework/generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor.rst", "framework/generated/torchtnt.framework.callbacks.TorchSnapshotSaver.rst", "framework/generated/torchtnt.framework.callbacks.TrainProgressMonitor.rst", "framework/predict.rst", "framework/state.rst", "framework/train.rst", "framework/unit.rst", "index.rst", "utils/data.rst", "utils/generated/torchtnt.utils.data.AllDatasetBatchesIterator.rst", "utils/generated/torchtnt.utils.data.CudaDataPrefetcher.rst", "utils/generated/torchtnt.utils.data.InOrderIterator.rst", "utils/generated/torchtnt.utils.data.MultiDataLoader.rst", "utils/generated/torchtnt.utils.data.MultiIterator.rst", "utils/generated/torchtnt.utils.data.RandomizedBatchSamplerIterator.rst", "utils/generated/torchtnt.utils.data.RoundRobinIterator.rst", "utils/generated/torchtnt.utils.loggers.CSVLogger.rst", "utils/generated/torchtnt.utils.loggers.InMemoryLogger.rst", "utils/generated/torchtnt.utils.loggers.JSONLogger.rst", "utils/generated/torchtnt.utils.loggers.TensorBoardLogger.rst", "utils/loggers.rst", "utils/utils.rst"], "titles": ["Checkpointing", "Distributed training", "Examples", "AutoUnit", "Callbacks", "Evaluate", "Fit", "BaseCSVWriter", "GarbageCollector", "IterationTimeLogger", "Lambda", "LearningRateMonitor", "ModuleSummary", "PyTorchProfiler", "SystemResourcesMonitor", "TQDMProgressBar", "TensorBoardParameterMonitor", "TorchSnapshotSaver", "TrainProgressMonitor", "Predict", "State", "Train", "Unit", "Welcome to the TorchTNT documentation!", "Data", "AllDatasetBatchesIterator", "CudaDataPrefetcher", "InOrderIterator", "MultiDataLoader", "MultiIterator", "RandomizedBatchSamplerIterator", "RoundRobinIterator", "CSVLogger", "InMemoryLogger", "JSONLogger", "TensorBoardLogger", "Loggers", "Utils"], "terms": {"torchtnt": [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37], "offer": [0, 1, 3, 4, 17, 22, 24, 36], "via": [0, 31], "torchsnapshotsav": 0, "which": [0, 1, 3, 4, 5, 6, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 26, 28, 37], "us": [0, 1, 2, 3, 4, 5, 6, 12, 13, 17, 19, 20, 21, 22, 26, 30, 35, 36, 37], "torchsnapshot": [0, 17], "under": [0, 17, 22, 37], "hood": 0, "modul": [0, 1, 3, 5, 6, 12, 16, 19, 21, 22, 23, 37], "nn": [0, 1, 3, 22, 37], "linear": [0, 1, 37], "input_dim": [0, 1], "1": [0, 1, 6, 8, 9, 15, 25, 26, 27, 30, 31, 37], "unit": [0, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 21, 23], "myunit": [0, 10, 22], "tss": 0, "dirpath": [0, 17], "your_dirpath_her": 0, "save_every_n_train_step": [0, 17], "100": [0, 32, 34], "save_every_n_epoch": [0, 17], "2": [0, 3, 25, 26, 27, 30, 31, 37], "load": [0, 1, 17, 26, 28, 37], "latest": [0, 17, 23], "exist": 0, "latest_checkpoint_dir": 0, "restore_from_latest": [0, 17], "train_dataload": [0, 4, 6, 17, 21], "dataload": [0, 3, 5, 6, 10, 17, 19, 20, 21, 22, 25, 26, 27, 28, 29, 30, 31, 37], "train": [0, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 22, 23, 35, 37], "callback": [0, 1, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 21, 23], "There": [0, 17], "built": [0, 23], "support": [0, 3, 25, 27, 28, 29, 31, 37], "save": [0, 7, 17, 35, 37], "distribut": [0, 8, 15, 17, 23, 35, 37], "model": [0, 1, 2, 3, 4, 8, 17, 22, 37], "ddp": [0, 1, 3, 37], "fsdp": [0, 1, 3, 17, 37], "The": [0, 1, 2, 3, 5, 6, 7, 8, 12, 19, 21, 22, 28, 37], "state": [0, 3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 22, 23, 28, 37], "dict": [0, 12, 17, 25, 27, 28, 33, 35, 36, 37], "type": [0, 12, 17, 22, 28, 35, 37], "can": [0, 1, 2, 3, 4, 5, 6, 8, 17, 19, 20, 21, 22, 23, 24, 26, 27, 29, 30, 31, 35, 36, 37], "specifi": [0, 22, 37], "fsdpstrategi": [0, 1, 37], "s": [0, 2, 3, 5, 6, 8, 17, 19, 21, 22, 28, 37], "state_dict_typ": [0, 37], "argument": [0, 1, 5, 6, 19, 21, 35, 37], "like": [0, 1, 3, 29, 37], "so": [0, 1, 23], "fsdp_strategi": [0, 1], "set": [0, 1, 5, 6, 14, 17, 19, 21, 25, 30, 37], "sharded_state_dict": 0, "prepare_fsdp": [0, 1, 37], "strategi": [0, 1, 3, 31, 37], "Or": 0, "you": [0, 1, 17, 22, 23, 37], "manual": 0, "thi": [0, 1, 3, 4, 6, 7, 8, 17, 18, 22, 25, 26, 27, 28, 30, 31, 35, 37], "set_state_dict_typ": [0, 17], "statedicttyp": [0, 37], "core": [1, 3, 22], "tnt": [1, 2, 23], "framework": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], "make": [1, 8, 23, 24, 37], "assumpt": 1, "about": [1, 3, 20, 22, 37], "devic": [1, 3, 26, 37], "expect": 1, "user": [1, 3, 13, 17, 20, 22, 26, 36], "handl": [1, 3, 37], "configur": [1, 8], "own": [1, 4, 36], "As": [1, 8, 37], "conveni": [1, 3, 8, 22, 37], "autounit": [1, 23], "who": [1, 3], "prefer": 1, "automat": [1, 8], "provid": [1, 7, 17, 27, 28, 29, 30, 37], "checkpoint": [1, 3, 4, 17, 23, 37], "If": [1, 3, 12, 17, 23, 35, 37], "ar": [1, 3, 4, 17, 22, 23, 25, 27, 28, 29, 30, 31, 32, 36, 37], "trainunit": [1, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 21], "evalunit": [1, 3, 4, 5, 6, 7, 8, 10, 12, 13, 14, 15, 17], "predictunit": [1, 4, 7, 8, 10, 12, 13, 14, 15, 17, 19], "interfac": [1, 3, 7, 22, 37], "initi": [1, 3, 15, 17, 35, 37], "cuda": [1, 3, 5, 6, 14, 19, 21, 26, 37], "applic": [1, 8, 17, 37], "along": 1, "global": [1, 35, 37], "process": [1, 7, 8, 17, 35, 37], "group": [1, 11, 17, 33, 35, 36, 37], "from": [1, 3, 4, 5, 6, 10, 12, 17, 19, 21, 22, 23, 25, 27, 28, 29, 30, 33, 35, 37], "torch": [1, 3, 5, 6, 9, 13, 16, 17, 19, 21, 22, 25, 26, 27, 30, 31, 37], "we": [1, 4, 8, 24, 26, 36, 37], "function": [1, 3, 4, 10, 12, 22, 28, 29, 37], "init_from_env": [1, 37], "work": [1, 37], "torchelast": 1, "should": [1, 3, 4, 6, 7, 17, 26, 28, 32, 33, 34, 35, 36, 37], "invok": [1, 37], "begin": [1, 18, 37], "your": [1, 4, 22], "script": [1, 37], "simpli": 1, "wrap": [1, 37], "around": [1, 23, 36, 37], "move": [1, 9, 26, 27, 37], "device_id": 1, "index": [1, 29, 37], "distributeddataparallel": [1, 37], "also": [1, 17, 23, 28, 29, 36, 37], "prepare_ddp": [1, 37], "assist": 1, "when": [1, 2, 3, 4, 7, 10, 12, 17, 18, 20, 25, 26, 37], "either": [1, 3, 9, 11, 14, 16, 18, 37], "string": [1, 3, 7, 33, 35, 36, 37], "pass": [1, 3, 4, 17, 28, 32, 35, 37], "my_auto_unit": 1, "myautounit": 1, "dataclass": [1, 25, 27, 28, 29, 30, 31, 37], "ddpstrategi": [1, 37], "help": [1, 18, 24], "want": [1, 12, 17, 22], "custom": [1, 3, 17, 27, 37], "ddp_strategi": 1, "broadcast_buff": [1, 37], "fals": [1, 17, 28, 32, 34, 37], "check_reduct": [1, 37], "true": [1, 3, 17, 32, 34, 36, 37], "one": [1, 3, 7, 22, 27, 31, 37], "more": [1, 2, 3, 17, 26, 28, 29, 37], "fullyshardeddataparallel": [1, 37], "forward_prefetch": [1, 37], "limit_all_gath": [1, 37], "show": 2, "how": [2, 3, 6, 25, 27, 28, 29, 30, 31], "basic": [2, 4, 22], "It": [2, 15, 23, 28, 37], "found": [2, 17, 37], "here": [2, 22, 37], "http": [2, 3, 16, 17, 23, 26, 29, 37], "github": [2, 23], "com": [2, 23], "pytorch": [2, 3, 5, 6, 13, 16, 17, 19, 21, 23, 26, 29, 37], "blob": 2, "master": [2, 23], "train_unit_exampl": 2, "py": 2, "less": [2, 37], "code": [2, 3, 4, 8, 13, 22, 37], "featur": 2, "enabl": [2, 3, 37], "out": [2, 4, 36, 37], "box": [2, 4, 36], "auto_unit_exampl": 2, "datapip": 2, "dataloader2": [2, 5, 6, 19, 21], "torchdata_train_exampl": 2, "convnet": 2, "dataset": [2, 18, 25, 27, 30, 31], "main": [2, 17, 23], "class": [3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 20, 22, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37], "auto_unit": 3, "arg": [3, 10, 12, 35, 36, 37], "kwarg": [3, 12, 35, 36, 37], "stochast": 3, "gradient": [3, 8], "descent": 3, "would": 3, "have": [3, 17, 37], "optim": [3, 5, 6, 11, 19, 21, 22], "data": [3, 5, 6, 18, 19, 21, 22, 23, 25, 26, 27, 28, 29, 30, 31, 33, 35, 36, 37], "parallel": 3, "replic": [3, 17], "them": [3, 26], "subclass": [3, 4, 6, 22, 28, 36], "implement": [3, 5, 6, 7, 19, 21, 22, 28, 37], "train_step": [3, 6, 21, 22], "eval_step": [3, 5, 6, 22], "method": [3, 17, 22, 37], "For": [3, 17, 28, 29, 37], "run": [3, 5, 6, 8, 10, 19, 20, 21, 22, 23, 37], "forward": [3, 37], "loss": [3, 22], "comput": [3, 26], "backward": [3, 22, 37], "step": [3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 17, 18, 19, 20, 21, 22, 32, 33, 34, 35, 36, 37], "onli": [3, 15, 20, 28, 32, 34, 35, 36, 37], "To": [3, 4, 22, 23, 37], "benefit": 3, "must": [3, 7, 8, 35, 37], "compute_loss": 3, "configure_optimizers_and_lr_schedul": 3, "addition": [3, 37], "option": [3, 4, 5, 6, 9, 10, 12, 17, 19, 20, 21, 22, 28, 32, 34, 35, 37], "hook": [3, 4, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 22, 37], "on_train_step_end": [3, 4, 6, 8, 9, 10, 13, 15, 17, 21], "on_eval_step_end": [3, 4, 5, 8, 10, 13, 15], "Then": [3, 22], "evalu": [3, 4, 6, 8, 10, 12, 13, 15, 17, 20, 22, 23], "fit": [3, 4, 17, 20, 22, 23], "entri": [3, 4, 17, 20, 37], "point": [3, 4, 8, 20, 22, 37], "normal": 3, "advanc": 3, "directli": [3, 33], "paramet": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 21, 22, 25, 26, 27, 29, 30, 31, 32, 33, 34, 35, 36, 37], "dure": [3, 4, 5, 6, 7, 10, 17, 19, 20, 21, 37], "step_lr_interv": 3, "whether": [3, 14, 17, 20, 37], "lr_schedul": [3, 5, 6, 19, 21, 22], "everi": [3, 8, 14, 18], "epoch": [3, 4, 5, 6, 10, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 37], "default": [3, 7, 8, 12, 14, 17, 27, 28, 30, 35, 37], "precis": [3, 37], "dtype": [3, 37], "gradient_accumulation_step": 3, "mani": 3, "batch": [3, 22, 25, 26, 27, 29, 30, 31, 35, 37], "accumul": 3, "over": [3, 25, 27, 28, 29, 30, 31], "detect_anomali": 3, "anomali": 3, "detect": 3, "autograd": 3, "engin": 3, "org": [3, 16, 17, 26, 29, 37], "doc": [3, 16, 26, 37], "stabl": [3, 16, 26, 37], "html": [3, 16, 17, 26, 29, 37], "clip_grad_norm": 3, "max": [3, 5, 6, 19, 21, 37], "norm": [3, 37], "clip": 3, "gener": [3, 4, 8, 12, 17, 28, 29, 37], "util": [3, 5, 6, 9, 12, 16, 17, 19, 21, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36], "clip_grad_norm_": 3, "clip_grad_valu": 3, "valu": [3, 25, 27, 28, 29, 30, 31, 33, 35, 36, 37], "clip_grad_value_": 3, "swa_param": 3, "param": [3, 35, 37], "weight": [3, 30], "averag": [3, 9], "torch_compile_param": 3, "compil": 3, "activation_checkpoint_param": 3, "activ": [3, 12, 20, 37], "lr": 3, "schedul": [3, 11, 22], "creat": [3, 8, 22, 35, 36, 37], "after": [3, 4, 6, 7, 8, 9, 13, 15, 16, 17, 18, 20, 22, 30, 32, 33, 34, 35, 36, 37], "current": [3, 20, 37], "avail": [3, 17, 37], "0": [3, 15, 17, 25, 27, 30, 31, 32, 34, 35, 36, 37], "higher": 3, "abstract": [3, 22, 23, 24, 36], "tdata": 3, "tupl": [3, 12, 22, 37], "tensor": [3, 22, 25, 27, 30, 31, 33, 35, 36, 37], "ani": [3, 5, 6, 12, 17, 19, 20, 21, 22, 28, 35, 37], "call": [3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, 21, 22, 32, 33, 34, 35, 36, 37], "object": [3, 5, 6, 8, 19, 20, 21, 22, 25, 27, 28, 29, 30, 31, 37], "return": [3, 17, 22, 25, 27, 28, 30, 31, 35, 37], "contain": [3, 17, 20, 22, 23, 25, 26, 28, 37], "output": [3, 7, 20, 22, 37], "part": 3, "lrschedul": [3, 37], "learn": [3, 11, 22], "rate": [3, 11, 15, 22], "construct": [3, 26, 35, 37], "upon": 3, "A": [3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 20, 25, 27, 28, 29, 30, 31, 37], "requir": [3, 22, 37], "each": [3, 7, 8, 10, 11, 17, 20, 22, 30, 37], "iter": [3, 5, 6, 9, 18, 19, 20, 21, 22, 25, 26, 27, 28, 29, 30, 31, 37], "eval": [3, 4, 5, 6, 8, 10, 13, 14, 15, 17, 19, 20, 22], "wish": [3, 22], "decor": [3, 22], "inference_mod": [3, 22], "improv": [3, 8, 22, 37], "perform": [3, 5, 6, 8, 19, 21, 22], "metadata": [3, 22], "move_data_to_devic": 3, "non_block": 3, "bool": [3, 17, 20, 28, 32, 34, 36, 37], "overrid": [3, 35], "copi": [3, 26, 37], "start": [3, 4, 7, 8, 10, 11, 12, 13, 14, 15, 17, 18, 20, 22, 37], "By": [3, 7, 8, 17, 27, 30, 37], "copy_data_to_devic": [3, 37], "gpu": [3, 14, 37], "separ": [3, 7, 37], "stream": [3, 37], "int": [3, 5, 6, 8, 9, 12, 15, 17, 19, 20, 21, 26, 32, 33, 34, 35, 36, 37], "none": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 28, 32, 33, 34, 35, 36, 37], "end": [3, 4, 7, 8, 9, 10, 13, 15, 16, 17, 18, 20, 22], "befor": [3, 4, 7, 8, 11, 12, 13, 14, 15, 18, 22, 32, 34, 36, 37], "updat": [3, 8, 15, 23], "log": [3, 9, 11, 12, 14, 16, 18, 23, 32, 33, 34, 35, 36, 37], "metric": [3, 23, 35, 36, 37], "do": [3, 23], "anyth": 3, "els": [3, 32, 34, 36], "been": [3, 25, 31, 37], "complet": [3, 17, 20, 37], "on_train_end": [3, 4, 6, 8, 10, 13, 17, 21, 22], "note": [3, 17, 37], "swa": 3, "super": [3, 22], "on_train_epoch_end": [3, 4, 6, 10, 15, 16, 17, 18, 21, 22], "rememb": 3, "autopredictunit": 3, "union": [3, 4, 7, 9, 10, 11, 14, 16, 17, 18, 25, 27, 28, 29, 30, 31, 33, 35, 36, 37], "str": [3, 4, 7, 11, 12, 17, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37], "torchcompileparam": 3, "tpredictdata": [3, 4, 7, 8, 10, 12, 13, 14, 15, 17, 19, 22], "predict_step": [3, 19, 22], "on_predict_step_end": [3, 4, 7, 8, 10, 13, 15, 19], "predict": [3, 4, 7, 8, 10, 12, 13, 14, 15, 20, 22, 23], "an": [4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 20, 21, 22, 26, 28, 37], "extens": 4, "supplement": [4, 17], "loop": [4, 5, 6, 8, 10, 19, 20, 21, 22, 23, 37], "addit": [4, 17, 37], "good": 4, "candid": 4, "logic": [4, 22, 28, 29], "ones": 4, "re": [4, 37], "across": [4, 7, 8, 17, 18, 37], "intend": [4, 37], "go": 4, "write": [4, 7, 18, 32, 34, 35, 36, 37], "add": [4, 33, 35, 36, 37], "below": [4, 5, 6, 19, 21, 22], "exampl": [4, 5, 6, 10, 19, 21, 22, 25, 26, 27, 28, 29, 30, 31, 33, 35, 37], "print": [4, 10, 12, 14, 25, 27, 30, 31, 37], "messag": [4, 37], "variou": [4, 23], "execut": [4, 5, 6, 8, 19, 20, 21, 37], "import": [4, 5, 6, 8, 10, 19, 21, 22, 33, 35, 37], "tevalunit": 4, "tpredictunit": 4, "ttrainunit": 4, "printingcallback": 4, "def": [4, 10, 22], "on_train_start": [4, 6, 8, 10, 12, 13, 17, 18, 21, 22], "self": [4, 22], "on_eval_start": [4, 5, 8, 10, 12, 13, 22], "on_eval_end": [4, 5, 8, 10, 13, 22], "on_predict_start": [4, 7, 8, 10, 12, 13, 19, 22], "on_predict_end": [4, 7, 8, 10, 13, 19, 22], "instanti": 4, "printing_callback": 4, "train_unit": [4, 21, 22], "properti": [4, 17, 20, 33, 36, 37], "name": [4, 7, 12, 17, 25, 27, 28, 29, 30, 31, 32, 33, 35, 36, 37], "distinct": 4, "per": [4, 5, 6, 19, 20, 21], "instanc": [4, 5, 6, 9, 16, 17, 19, 20, 21, 28, 37], "debug": [4, 20], "profil": [4, 13, 37], "purpos": 4, "tevaldata": [4, 5, 6, 7, 8, 10, 12, 13, 14, 15, 17, 22], "on_eval_epoch_end": [4, 5, 10, 15, 22], "on_eval_epoch_start": [4, 5, 10, 14, 15, 22], "new": [4, 11, 14, 15, 22, 35], "on_eval_step_start": [4, 5, 10, 14], "on_except": [4, 7, 10, 17], "ttraindata": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 21, 22], "exc": [4, 7, 17], "baseexcept": [4, 7, 10, 17, 37], "except": [4, 5, 6, 7, 10, 17, 19, 21, 28, 37], "occur": [4, 7, 10, 17, 18, 37], "on_predict_epoch_end": [4, 10, 15, 19, 22], "on_predict_epoch_start": [4, 10, 14, 15, 19, 22], "on_predict_step_start": [4, 10, 14, 19], "on_train_epoch_start": [4, 6, 10, 11, 14, 15, 21, 22], "on_train_step_start": [4, 6, 10, 11, 14, 21], "sever": [4, 22, 24, 37], "pre": 4, "written": [4, 7, 32, 33, 34, 35, 36], "readi": 4, "eval_unit": [5, 22], "eval_dataload": [5, 6], "max_steps_per_epoch": [5, 19, 20, 21, 37], "list": [5, 6, 7, 11, 12, 14, 17, 18, 19, 21, 37], "timer": [5, 6, 19, 20, 21, 37], "timerprotocol": [5, 6, 19, 20, 21, 37], "take": [5, 6, 8, 17, 19, 21], "modifi": [5, 6, 19, 20, 21], "includ": [5, 6, 14, 19, 21, 23, 28, 29, 37], "etc": [5, 6, 12, 19, 21, 28, 29], "number": [5, 6, 8, 15, 17, 19, 20, 21, 26, 32, 34, 36, 37], "mean": [5, 6, 19, 21, 37], "until": [5, 6, 19, 21, 25], "exhaust": [5, 6, 19, 21, 25, 27, 30, 31], "time": [5, 6, 8, 9, 19, 20, 21, 32, 35, 37], "kei": [5, 6, 17, 19, 20, 21, 25, 27, 28, 29, 30, 31, 37], "event": [5, 6, 19, 20, 21, 35, 37], "synchron": [5, 6, 8, 19, 21, 35, 37], "mai": [5, 6, 19, 21, 37], "degrad": [5, 6, 19, 21], "myevalunit": [5, 22], "20": [5, 19], "pseudocod": [5, 6, 19, 21], "what": [5, 6, 19, 21, 37], "doe": [5, 6, 8, 19, 21, 37], "track": [5, 6, 11, 19, 21, 37], "mode": [5, 6, 19, 21, 37], "first": [5, 6, 19, 21, 23], "while": [5, 6, 19, 21, 25, 31, 36], "done": [5, 6, 19, 21, 25, 31, 37], "try": [5, 6, 19, 21], "next": [5, 6, 19, 21, 27], "increment": [5, 6, 19, 21, 37], "counter": [5, 6, 19, 21, 37], "stopiter": [5, 6, 19, 21], "break": [5, 6, 19, 21], "max_epoch": [6, 20, 21], "max_step": [6, 20, 21, 37], "max_train_steps_per_epoch": 6, "max_eval_steps_per_epoch": 6, "evaluate_every_n_step": [6, 20], "evaluate_every_n_epoch": [6, 20], "interleav": [6, 22, 26], "both": 6, "limit": [6, 21], "infinit": [6, 21, 37], "unless": [6, 21], "stop": [6, 20, 21, 25, 30, 31, 37], "often": 6, "term": [6, 18, 20], "fit_unit": 6, "myfitunit": 6, "4": [6, 21, 25, 27, 30, 31, 37], "header_row": 7, "dir_path": 7, "delimit": 7, "t": [7, 37], "filenam": 7, "csv": [7, 32], "file": [7, 32, 34, 35, 36, 37], "simplifi": [7, 23, 36], "extend": [7, 22], "get_step_output_row": 7, "desir": 7, "row": 7, "all": [7, 8, 12, 17, 25, 27, 29, 30, 32, 34, 35, 36, 37], "same": [7, 8, 17, 22, 27, 28, 29, 37], "match": 7, "column": 7, "defin": [7, 20, 22, 28, 29, 31, 35, 37], "directori": [7, 17, 37], "path": [7, 17, 32, 34, 35, 36, 37], "where": [7, 17, 22, 37], "tab": 7, "step_interv": 8, "period": [8, 17, 37], "garbag": 8, "collect": [8, 17, 35, 37], "In": [8, 22, 37], "fulli": 8, "program": [8, 37], "multipl": [8, 33, 35, 36, 37], "These": [8, 22, 37], "need": [8, 22, 37], "commun": [8, 37], "other": [8, 17, 37], "especi": [8, 18], "overal": 8, "therefor": 8, "gate": 8, "slowest": 8, "result": [8, 37], "roughli": 8, "amount": 8, "its": [8, 37], "otherwis": [8, 17, 37], "straggler": 8, "python": [8, 37], "trigger": 8, "differ": [8, 22, 23, 36, 37], "possibl": 8, "lead": 8, "frequenc": [8, 9, 17, 20], "tune": 8, "base": [8, 28, 37], "hand": 8, "free": [8, 37], "up": [8, 20], "some": [8, 22], "reap": 8, "minim": 8, "overhead": 8, "compar": 8, "full": 8, "logger": [9, 11, 14, 16, 18, 23, 32, 33, 34, 35, 37], "tensorboardlogg": [9, 16], "summarywrit": [9, 16, 35], "moving_avg_window": 9, "log_every_n_step": 9, "scalar": [9, 33, 35, 36], "tensorboard": [9, 16, 35], "control": [9, 22, 37], "window": [9, 37], "callabl": [10, 12, 37], "accept": 10, "mydataload": 10, "print_on_step_start": 10, "f": [10, 37], "eval_progress": 10, "num_steps_complet": [10, 37], "lambda_cb": 10, "metriclogg": [11, 14, 18, 36], "logging_interv": [11, 14], "associ": 11, "max_depth": [12, 37], "process_fn": 12, "module_summari": [12, 37], "_log_module_summary_t": 12, "module_input": [12, 37], "mutablemap": [12, 37], "summari": [12, 35, 37], "maximum": [12, 20, 37], "depth": [12, 37], "keep": [12, 37], "tabl": 12, "map": [12, 25, 27, 29, 30, 31, 33, 35, 36, 37], "flop": [12, 37], "size": [12, 14, 37], "rais": [12, 28, 37], "runtimeerror": [12, 37], "torchev": 12, "instal": 12, "context": [13, 37], "manag": [13, 37], "liter": [14, 37], "system": [14, 37], "stat": [14, 37], "cpu": [14, 20, 37], "usag": 14, "resid": [14, 37], "memori": [14, 26, 33, 37], "refresh_r": [15, 37], "progress": [15, 17, 18, 37], "bar": 15, "visual": [15, 18, 37], "rank": [15, 17, 32, 34, 35, 36, 37], "environ": [15, 35, 37], "determin": [15, 37], "get": [15, 17, 29, 37], "histogram": 16, "writer": [16, 35], "storage_opt": 17, "appstatemixin": 17, "random": [17, 37], "epoch_": 17, "_step_": 17, "total": [17, 37], "parent": [17, 20, 35], "snapshot": [17, 37], "intra": 17, "glob": 17, "pattern": 17, "indic": [17, 25, 27, 28, 29, 30, 31, 37], "inform": [17, 20, 37], "see": [17, 37], "api_refer": 17, "keyword": [17, 35, 37], "storag": 17, "plugin": 17, "document": [17, 28, 29], "constructor": 17, "oper": [17, 26, 35, 37], "broadcast": [17, 37], "state_dict": [17, 28, 37], "prior": 17, "valid": 17, "collis": 17, "app": [17, 37], "static": 17, "restor": [17, 37], "restore_train_progress": 17, "restore_eval_progress": 17, "flag": 17, "skip": [17, 25, 28, 31], "given": [17, 29, 37], "wa": [17, 37], "successfulli": 17, "vs": [18, 37], "predict_unit": [19, 22], "predict_dataload": 19, "mypredictunit": [19, 22], "entry_point": 20, "entrypoint": 20, "train_stat": 20, "eval_st": 20, "predict_st": 20, "3": [20, 25, 27, 30, 31, 37], "phase": [20, 22], "read": [20, 28, 29], "active_phas": 20, "activephas": 20, "One": 20, "meta": 20, "should_stop": 20, "termin": 20, "signal": [20, 37], "record": [20, 33, 35, 36, 37], "latenc": 20, "iteration_tim": 20, "alwai": 20, "without": [20, 37], "synchronis": 20, "step_output": 20, "last": 20, "mytrainunit": [21, 22], "concept": 22, "repres": [22, 37], "primari": 22, "place": 22, "organ": 22, "three": [22, 25], "mutual": 22, "exclus": 22, "e": [22, 37], "g": [22, 37], "case": [22, 37], "allow": [22, 37], "behavior": 22, "simpl": [22, 33, 35], "typecheck": 22, "__init__": 22, "_lrschedul": 22, "input": [22, 27, 37], "target": 22, "binary_cross_entropy_with_logit": 22, "zero_grad": 22, "plan": 22, "refer": [22, 28, 29, 37], "my_unit": 22, "librari": [23, 37], "tool": 23, "ha": [23, 25, 28, 29, 31, 37], "two": [23, 31, 37], "compon": 23, "top": 23, "level": 23, "repo": 23, "lightweight": 23, "maintain": 23, "grab": 23, "bag": 23, "independ": 23, "relat": [23, 24, 37], "wrapper": [23, 36, 37], "publish": [23, 36], "pip": 23, "issu": [23, 37], "sure": 23, "version": [23, 37], "just": 23, "git": 23, "upgrad": 23, "alldatasetbatchesiter": 23, "cudadataprefetch": 23, "inorderiter": 23, "multidataload": 23, "multiiter": [23, 28], "randomizedbatchsampleriter": [23, 27], "roundrobiniter": 23, "prepar": 24, "easier": 24, "individual_dataload": [25, 27, 28, 29, 30, 31], "iteration_strategi": [25, 27, 28, 29, 30, 31], "alldatasetbatch": 25, "mechan": [25, 30, 31], "all_datasets_exhaust": [25, 30, 31], "finish": 25, "till": [25, 27, 31], "largest": [25, 31], "those": [25, 31], "smallest_dataset_exhaust": [25, 31], "onc": [25, 31, 37], "smallest": [25, 31], "restart_until_all_datasets_exhaust": 25, "restart": 25, "format": [25, 27, 30, 31], "dataloader_1_nam": 25, "batch_obtained_from_dataloader_1": 25, "dataloader_2_nam": 25, "batch_obtained_from_dataloader_2": 25, "loader": [25, 27, 30, 31], "rang": [25, 27, 30, 31, 37], "batch_siz": [25, 27, 30, 31], "b": [25, 27, 30, 31], "15": [25, 27, 30, 31], "5": [25, 27, 30, 31, 37], "all_dataset_batch_strategi": 25, "stopping_mechan": [25, 30, 31], "stoppingmechan": [25, 30, 31], "combined_iter": [25, 27, 30, 31], "item": [25, 27, 30, 31], "6": [25, 27, 30, 31], "7": [25, 27, 30, 31], "8": [25, 27, 30, 31, 37], "9": [25, 27, 30, 31], "10": [25, 27, 30, 31, 33, 35], "11": [25, 27, 30, 31], "12": [25, 27, 30, 31, 37], "13": [25, 27, 30, 31, 37], "14": [25, 27, 30, 31], "data_iter": 26, "num_prefetch_batch": 26, "prefetch": 26, "host": [26, 37], "effect": 26, "recommend": 26, "leverag": 26, "pin": 26, "data_prefetch": 26, "alreadi": [26, 37], "inord": 27, "singl": [27, 37], "order": [27, 29, 31, 37], "overridden": 27, "repetit": 27, "dataloader_nam": [27, 30, 31], "batch_from_dataload": [27, 30, 31], "randomizedbatchsampl": [27, 30], "in_order_strategi": 27, "dataiterationstrategi": [28, 29], "iterator_cl": 28, "ignore_empty_data": 28, "cycl": [28, 29, 31], "through": 28, "individu": [28, 29], "dictionari": [28, 33, 35, 36], "torchdata": [28, 29], "multi": [28, 29], "sourc": [28, 29, 37], "achiev": [28, 29], "mux": [28, 29], "mux_longest": [28, 29], "zip": [28, 29], "pleas": [28, 29, 37], "detail": [28, 29, 37], "load_state_dict": [28, 37], "aggreg": 28, "off": 28, "protocol": [28, 37], "accompani": 29, "particular": 29, "beta": 29, "randomli": 30, "sampl": 30, "chang": [30, 37], "anoth": 30, "randomized_batch_sampl": 30, "roundrobin": 31, "robinrobin": 31, "round_robin_strategi": 31, "steps_before_flush": [32, 34, 36], "log_all_rank": [32, 34, 36], "header": 32, "buffer": [32, 33], "flush": [32, 33, 34, 35, 36], "close": [32, 33, 34, 35, 36], "resourc": [32, 33, 34, 36], "necessari": [32, 33, 34, 36], "accuraci": [33, 35], "23": [33, 35], "56": [33, 35], "ndarrai": [33, 35, 36], "float": [33, 35, 36, 37], "uniqu": [33, 36], "log_buff": 33, "access": 33, "log_dict": [33, 35, 36], "payload": [33, 35, 36], "tag": [33, 35, 36], "json": 34, "store": [34, 36, 37], "On": 35, "variabl": [35, 37], "extra": 35, "posit": [35, 37], "tmp": 35, "tb_log": 35, "pend": 35, "disk": 35, "cannot": 35, "log_audio": 35, "audio": 35, "add_audio": 35, "log_hparam": 35, "hparam": 35, "hyperparamet": 35, "correspond": [35, 37], "log_imag": 35, "imag": 35, "add_imag": 35, "log_scalar": 35, "main_tag": 35, "tag_scalar_dict": 35, "global_step": 35, "walltim": 35, "log_text": 35, "text": 35, "identifi": 35, "filelogg": 36, "abov": 36, "follow": [36, 37], "cpustat": 37, "cpu_perc": 37, "cpu_swap_perc": 37, "cpu_vm_perc": 37, "worker_cpu_time_system": 37, "worker_cpu_time_us": 37, "worker_rss": 37, "output_devic": 37, "dim": 37, "process_group": 37, "processgroup": 37, "bucket_cap_mb": 37, "25": 37, "find_unused_paramet": 37, "gradient_as_bucket_view": 37, "static_graph": 37, "comm_stat": 37, "comm_hook": 37, "gradbucket": 37, "futur": 37, "sync_batchnorm": 37, "regist": 37, "sync": 37, "earlystopcheck": 37, "min": 37, "patienc": 37, "min_delta": 37, "check_finit": 37, "threshold_mod": 37, "ab": 37, "rel": 37, "stopping_threshold": 37, "divergence_threshold": 37, "monitor": 37, "earli": 37, "decreas": 37, "increas": 37, "check": 37, "minimum": 37, "absolut": 37, "qualifi": 37, "improvement_threshold": 37, "best_val": 37, "threshold": 37, "becom": 37, "nan": 37, "delta": 37, "between": 37, "beyond": 37, "wors": 37, "than": 37, "valueerror": 37, "val": 37, "element": 37, "boolean": 37, "reset": 37, "back": 37, "reload": 37, "sharding_strategi": 37, "shardingstrategi": 37, "cpu_offload": 37, "cpuoffload": 37, "auto_wrap_polici": 37, "backward_prefetch": 37, "backwardprefetch": 37, "backward_pr": 37, "mixed_precis": 37, "mixedprecis": 37, "ignored_modul": 37, "sync_module_st": 37, "use_orig_param": 37, "state_dict_config": 37, "statedictconfig": 37, "optim_state_dict_config": 37, "optimstatedictconfig": 37, "floptensordispatchmod": 37, "measur": 37, "count": 37, "dev": 37, "discuss": 37, "ideal": 37, "dispatch": 37, "505": 37, "torchvis": 37, "resnet18": 37, "randn": 37, "224": 37, "ftdm": 37, "flops_forward": 37, "deepcopi": 37, "flop_count": 37, "flops_backward": 37, "fullsyncperiodictim": 37, "interv": 37, "timedelta": 37, "cpu_pg": 37, "elaps": 37, "propag": 37, "asynchron": 37, "previou": 37, "avoid": 37, "block": 37, "gpustat": 37, "fan_speed_perc": 37, "memory_free_mb": 37, "memory_used_mb": 37, "temperature_gpu_celsiu": 37, "temperature_memory_celsiu": 37, "utilization_gpu_perc": 37, "utilization_memory_perc": 37, "modulesummari": 37, "submodul": 37, "trainabl": 37, "estim": 37, "byte": 37, "uniniti": 37, "calcul": 37, "shape": 37, "ms": 37, "forward_elapsed_time_m": 37, "has_uninitialized_param": 37, "in_siz": 37, "module_nam": 37, "module_typ": 37, "num_paramet": 37, "num_trainable_paramet": 37, "requires_grad": 37, "out_siz": 37, "size_byt": 37, "submodule_summari": 37, "travers": 37, "pgwrapper": 37, "pg": 37, "consist": 37, "fashion": 37, "regardless": 37, "scenario": 37, "world": 37, "all_gather_object": 37, "obj_list": 37, "obj": 37, "barrier": 37, "broadcast_object_list": 37, "src": 37, "get_rank": 37, "get_world_s": 37, "scatter_object_list": 37, "output_list": 37, "input_list": 37, "num_epochs_complet": 37, "num_steps_completed_in_epoch": 37, "increment_epoch": 37, "within": 37, "increment_step": 37, "accord": 37, "thu": 37, "far": 37, "rssprofil": 37, "datetim": 37, "microsecond": 37, "100000": 37, "rss": 37, "baselin": 37, "rss_deltas_byt": 37, "100m": 37, "round": 37, "captur": 37, "thread": 37, "empti": 37, "tlrschedul": 37, "alia": 37, "cuda_sync": 37, "verbos": 37, "recorded_dur": 37, "action_nam": 37, "enclos": 37, "all_gather_tensor": 37, "gather": 37, "onto": 37, "dimens": 37, "pad": 37, "trim": 37, "secur": 37, "equal": 37, "workload": 37, "gathered_result": 37, "i": 37, "attach_oom_observ": 37, "output_dir": 37, "trace_max_entri": 37, "1000000": 37, "attach": 37, "error": 37, "blog": 37, "post": 37, "trace": 37, "granular": 37, "close_progress_bar": 37, "progress_bar": 37, "tqdm_asyncio": 37, "convert_precision_str_to_dtyp": 37, "convert": 37, "invalid": 37, "recurs": 37, "correct": 37, "create_progress_bar": 37, "desc": 37, "days_to_sec": 37, "dai": 37, "second": 37, "get_device_from_env": 37, "reli": 37, "local_rank": 37, "made": 37, "launcher": 37, "appropri": 37, "outsid": 37, "get_filesystem": 37, "abstractfilesystem": 37, "filesystem": 37, "get_global_rank": 37, "env": 37, "var": 37, "instead": 37, "neither": 37, "condit": 37, "met": 37, "get_local_rank": 37, "popul": 37, "elast": 37, "get_module_summari": 37, "module_arg": 37, "module_kwarg": 37, "assign": 37, "tree": 37, "summar": 37, "greater": 37, "lazi": 37, "NOT": 37, "todo": 37, "flexibl": 37, "get_nvidia_smi_gpu_stat": 37, "nvidia": 37, "smi": 37, "filenotfounderror": 37, "command": 37, "get_process_group_backend_from_devic": 37, "backend": 37, "get_psutil_cpu_stat": 37, "psutil": 37, "get_python_vers": 37, "runtim": 37, "get_summary_t": 37, "human_readable_num": 37, "summary_t": 37, "tabular": 37, "exact": 37, "1234": 37, "k": 37, "get_tensor_size_bytes_map": 37, "get_timer_summari": 37, "action": 37, "get_torch_vers": 37, "world_siz": 37, "device_typ": 37, "dist_init_method_typ": 37, "tcp": 37, "pg_backend": 37, "pg_timeout": 37, "1800": 37, "float32_matmul_precis": 37, "high": 37, "launch": 37, "spmd": 37, "style": 37, "timeout": 37, "against": 37, "30": 37, "minut": 37, "matrix": 37, "is_out_of_cpu_memori": 37, "oom": 37, "is_out_of_cuda_memori": 37, "is_out_of_memory_error": 37, "due": 37, "is_torch_version_ge_1_13_1": 37, "is_torch_version_geq_1_10": 37, "is_torch_version_geq_1_11": 37, "is_torch_version_geq_1_12": 37, "is_torch_version_geq_1_13": 37, "is_torch_version_geq_1_14": 37, "is_torch_version_geq_1_8": 37, "is_torch_version_geq_1_9": 37, "is_torch_version_geq_2_0": 37, "is_window": 37, "Is": 37, "log_elapsed_tim": 37, "being": 37, "most": 37, "accur": 37, "log_memory_snapshot": 37, "maybe_enable_tf32": 37, "condition": 37, "float32": 37, "conv": 37, "datatyp": 37, "measure_rss_delta": 37, "rss_delta": 37, "append": 37, "api": 37, "ddp_modul": 37, "fsdp_modul": 37, "prune_module_summari": 37, "prune": 37, "deeper": 37, "prun": 37, "inplac": 37, "root": 37, "rank_zero_crit": 37, "rank_zero_debug": 37, "rank_zero_error": 37, "rank_zero_info": 37, "rank_zero_print": 37, "rank_zero_warn": 37, "record_data_in_stream": 37, "mention": 37, "record_stream": 37, "cach": 37, "alloc": 37, "freed": 37, "reus": 37, "newli": 37, "still": 37, "tell": 37, "might": 37, "underli": 37, "longer": 37, "creator": 37, "notabl": 37, "trick": 37, "seed": 37, "determinist": 37, "pseudo": 37, "commonli": 37, "numpi": 37, "integ": 37, "don": 37, "warn": 37, "nondeterminist": 37, "cudnn": 37, "benchmark": 37, "disabl": 37, "set_deterministic_debug_mod": 37, "algorithm": 37, "sync_bool": 37, "coherence_mod": 37, "rank_zero": 37, "member": 37, "manner": 37, "receiv": 37, "truth": 37, "n": 37, "least": 37, "ratio": 37, "synced_v": 37, "iff": 37, "success": 37, "transfer_batch_norm_stat": 37, "src_modul": 37, "dst_modul": 37, "transfer": 37, "statist": 37, "transfer_weight": 37, "update_progress_bar": 37}, "objects": {"torchtnt.framework.auto_unit": [[3, 0, 1, "", "AutoPredictUnit"], [3, 0, 1, "", "AutoUnit"]], "torchtnt.framework.auto_unit.AutoPredictUnit": [[3, 1, 1, "", "move_data_to_device"], [3, 1, 1, "", "on_predict_step_end"], [3, 1, 1, "", "predict_step"]], "torchtnt.framework.auto_unit.AutoUnit": [[3, 1, 1, "", "compute_loss"], [3, 1, 1, "", "configure_optimizers_and_lr_scheduler"], [3, 1, 1, "", "eval_step"], [3, 1, 1, "", "move_data_to_device"], [3, 1, 1, "", "on_eval_step_end"], [3, 1, 1, "", "on_train_end"], [3, 1, 1, "", "on_train_epoch_end"], [3, 1, 1, "", "on_train_step_end"], [3, 1, 1, "", "train_step"]], "torchtnt.framework": [[4, 2, 0, "-", "callback"]], "torchtnt.framework.callback": [[4, 0, 1, "", "Callback"]], "torchtnt.framework.callback.Callback": [[4, 3, 1, "", "name"], [4, 1, 1, "", "on_eval_end"], [4, 1, 1, "", "on_eval_epoch_end"], [4, 1, 1, "", "on_eval_epoch_start"], [4, 1, 1, "", "on_eval_start"], [4, 1, 1, "", "on_eval_step_end"], [4, 1, 1, "", "on_eval_step_start"], [4, 1, 1, "", "on_exception"], [4, 1, 1, "", "on_predict_end"], [4, 1, 1, "", "on_predict_epoch_end"], [4, 1, 1, "", "on_predict_epoch_start"], [4, 1, 1, "", "on_predict_start"], [4, 1, 1, "", "on_predict_step_end"], [4, 1, 1, "", "on_predict_step_start"], [4, 1, 1, "", "on_train_end"], [4, 1, 1, "", "on_train_epoch_end"], [4, 1, 1, "", "on_train_epoch_start"], [4, 1, 1, "", "on_train_start"], [4, 1, 1, "", "on_train_step_end"], [4, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks": [[7, 0, 1, "", "BaseCSVWriter"], [8, 0, 1, "", "GarbageCollector"], [9, 0, 1, "", "IterationTimeLogger"], [10, 0, 1, "", "Lambda"], [11, 0, 1, "", "LearningRateMonitor"], [12, 0, 1, "", "ModuleSummary"], [13, 0, 1, "", "PyTorchProfiler"], [14, 0, 1, "", "SystemResourcesMonitor"], [15, 0, 1, "", "TQDMProgressBar"], [16, 0, 1, "", "TensorBoardParameterMonitor"], [17, 0, 1, "", "TorchSnapshotSaver"], [18, 0, 1, "", "TrainProgressMonitor"]], "torchtnt.framework.callbacks.BaseCSVWriter": [[7, 1, 1, "", "on_exception"], [7, 1, 1, "", "on_predict_end"], [7, 1, 1, "", "on_predict_start"], [7, 1, 1, "", "on_predict_step_end"]], "torchtnt.framework.callbacks.GarbageCollector": [[8, 1, 1, "", "on_eval_end"], [8, 1, 1, "", "on_eval_start"], [8, 1, 1, "", "on_eval_step_end"], [8, 1, 1, "", "on_predict_end"], [8, 1, 1, "", "on_predict_start"], [8, 1, 1, "", "on_predict_step_end"], [8, 1, 1, "", "on_train_end"], [8, 1, 1, "", "on_train_start"], [8, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.IterationTimeLogger": [[9, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.LearningRateMonitor": [[11, 1, 1, "", "on_train_epoch_start"], [11, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks.ModuleSummary": [[12, 1, 1, "", "on_eval_start"], [12, 1, 1, "", "on_predict_start"], [12, 1, 1, "", "on_train_start"]], "torchtnt.framework.callbacks.PyTorchProfiler": [[13, 1, 1, "", "on_eval_end"], [13, 1, 1, "", "on_eval_start"], [13, 1, 1, "", "on_eval_step_end"], [13, 1, 1, "", "on_predict_end"], [13, 1, 1, "", "on_predict_start"], [13, 1, 1, "", "on_predict_step_end"], [13, 1, 1, "", "on_train_end"], [13, 1, 1, "", "on_train_start"], [13, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.SystemResourcesMonitor": [[14, 1, 1, "", "on_eval_epoch_start"], [14, 1, 1, "", "on_eval_step_start"], [14, 1, 1, "", "on_predict_epoch_start"], [14, 1, 1, "", "on_predict_step_start"], [14, 1, 1, "", "on_train_epoch_start"], [14, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks.TQDMProgressBar": [[15, 1, 1, "", "on_eval_epoch_end"], [15, 1, 1, "", "on_eval_epoch_start"], [15, 1, 1, "", "on_eval_step_end"], [15, 1, 1, "", "on_predict_epoch_end"], [15, 1, 1, "", "on_predict_epoch_start"], [15, 1, 1, "", "on_predict_step_end"], [15, 1, 1, "", "on_train_epoch_end"], [15, 1, 1, "", "on_train_epoch_start"], [15, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.TensorBoardParameterMonitor": [[16, 1, 1, "", "on_train_epoch_end"]], "torchtnt.framework.callbacks.TorchSnapshotSaver": [[17, 3, 1, "", "dirpath"], [17, 1, 1, "", "on_exception"], [17, 1, 1, "", "on_train_end"], [17, 1, 1, "", "on_train_epoch_end"], [17, 1, 1, "", "on_train_start"], [17, 1, 1, "", "on_train_step_end"], [17, 1, 1, "", "restore"], [17, 1, 1, "", "restore_from_latest"]], "torchtnt.framework.callbacks.TrainProgressMonitor": [[18, 1, 1, "", "on_train_epoch_end"], [18, 1, 1, "", "on_train_start"]], "torchtnt.framework.evaluate": [[5, 4, 1, "", "evaluate"]], "torchtnt.framework.fit": [[6, 4, 1, "", "fit"]], "torchtnt.framework.predict": [[19, 4, 1, "", "predict"]], "torchtnt.framework.state": [[20, 0, 1, "", "PhaseState"], [20, 0, 1, "", "State"]], "torchtnt.framework.state.PhaseState": [[20, 3, 1, "", "dataloader"], [20, 3, 1, "", "evaluate_every_n_epochs"], [20, 3, 1, "", "evaluate_every_n_steps"], [20, 3, 1, "", "iteration_timer"], [20, 3, 1, "", "max_epochs"], [20, 3, 1, "", "max_steps"], [20, 3, 1, "", "max_steps_per_epoch"], [20, 3, 1, "", "step_output"]], "torchtnt.framework.state.State": [[20, 3, 1, "", "active_phase"], [20, 3, 1, "", "entry_point"], [20, 3, 1, "", "eval_state"], [20, 3, 1, "", "predict_state"], [20, 3, 1, "", "should_stop"], [20, 1, 1, "", "stop"], [20, 3, 1, "", "timer"], [20, 3, 1, "", "train_state"]], "torchtnt.framework.train": [[21, 4, 1, "", "train"]], "torchtnt.framework.unit": [[22, 0, 1, "", "EvalUnit"], [22, 0, 1, "", "PredictUnit"], [22, 0, 1, "", "TrainUnit"]], "torchtnt.framework.unit.EvalUnit": [[22, 1, 1, "", "eval_step"], [22, 1, 1, "", "on_eval_end"], [22, 1, 1, "", "on_eval_epoch_end"], [22, 1, 1, "", "on_eval_epoch_start"], [22, 1, 1, "", "on_eval_start"]], "torchtnt.framework.unit.PredictUnit": [[22, 1, 1, "", "on_predict_end"], [22, 1, 1, "", "on_predict_epoch_end"], [22, 1, 1, "", "on_predict_epoch_start"], [22, 1, 1, "", "on_predict_start"], [22, 1, 1, "", "predict_step"]], "torchtnt.framework.unit.TrainUnit": [[22, 1, 1, "", "on_train_end"], [22, 1, 1, "", "on_train_epoch_end"], [22, 1, 1, "", "on_train_epoch_start"], [22, 1, 1, "", "on_train_start"], [22, 1, 1, "", "train_step"]], "torchtnt": [[37, 2, 0, "-", "utils"]], "torchtnt.utils": [[37, 0, 1, "", "CPUStats"], [37, 0, 1, "", "DDPStrategy"], [37, 0, 1, "", "EarlyStopChecker"], [37, 0, 1, "", "FSDPStrategy"], [37, 0, 1, "", "FlopTensorDispatchMode"], [37, 0, 1, "", "FullSyncPeriodicTimer"], [37, 0, 1, "", "GPUStats"], [37, 0, 1, "", "ModuleSummary"], [37, 0, 1, "", "PGWrapper"], [37, 0, 1, "", "Progress"], [37, 0, 1, "", "RSSProfiler"], [37, 0, 1, "", "Stateful"], [37, 5, 1, "", "TLRScheduler"], [37, 0, 1, "", "Timer"], [37, 4, 1, "", "all_gather_tensors"], [37, 4, 1, "", "attach_oom_observer"], [37, 4, 1, "", "barrier"], [37, 4, 1, "", "close_progress_bar"], [37, 4, 1, "", "convert_precision_str_to_dtype"], [37, 4, 1, "", "copy_data_to_device"], [37, 4, 1, "", "create_progress_bar"], [24, 2, 0, "-", "data"], [37, 4, 1, "", "days_to_secs"], [37, 4, 1, "", "get_device_from_env"], [37, 4, 1, "", "get_filesystem"], [37, 4, 1, "", "get_global_rank"], [37, 4, 1, "", "get_local_rank"], [37, 4, 1, "", "get_module_summary"], [37, 4, 1, "", "get_nvidia_smi_gpu_stats"], [37, 4, 1, "", "get_process_group_backend_from_device"], [37, 4, 1, "", "get_psutil_cpu_stats"], [37, 4, 1, "", "get_python_version"], [37, 4, 1, "", "get_summary_table"], [37, 4, 1, "", "get_tensor_size_bytes_map"], [37, 4, 1, "", "get_timer_summary"], [37, 4, 1, "", "get_torch_version"], [37, 4, 1, "", "get_world_size"], [37, 4, 1, "", "init_from_env"], [37, 4, 1, "", "is_out_of_cpu_memory"], [37, 4, 1, "", "is_out_of_cuda_memory"], [37, 4, 1, "", "is_out_of_memory_error"], [37, 4, 1, "", "is_torch_version_ge_1_13_1"], [37, 4, 1, "", "is_torch_version_geq_1_10"], [37, 4, 1, "", "is_torch_version_geq_1_11"], [37, 4, 1, "", "is_torch_version_geq_1_12"], [37, 4, 1, "", "is_torch_version_geq_1_13"], [37, 4, 1, "", "is_torch_version_geq_1_14"], [37, 4, 1, "", "is_torch_version_geq_1_8"], [37, 4, 1, "", "is_torch_version_geq_1_9"], [37, 4, 1, "", "is_torch_version_geq_2_0"], [37, 4, 1, "", "is_windows"], [37, 4, 1, "", "log_elapsed_time"], [37, 4, 1, "", "log_memory_snapshot"], [36, 2, 0, "-", "loggers"], [37, 4, 1, "", "maybe_enable_tf32"], [37, 4, 1, "", "measure_rss_deltas"], [37, 4, 1, "", "prepare_ddp"], [37, 4, 1, "", "prepare_fsdp"], [37, 4, 1, "", "prune_module_summary"], [37, 4, 1, "", "rank_zero_critical"], [37, 4, 1, "", "rank_zero_debug"], [37, 4, 1, "", "rank_zero_error"], [37, 4, 1, "", "rank_zero_info"], [37, 4, 1, "", "rank_zero_print"], [37, 4, 1, "", "rank_zero_warn"], [37, 4, 1, "", "record_data_in_stream"], [37, 4, 1, "", "seed"], [37, 4, 1, "", "sync_bool"], [37, 4, 1, "", "transfer_batch_norm_stats"], [37, 4, 1, "", "transfer_weights"], [37, 4, 1, "", "update_progress_bar"]], "torchtnt.utils.CPUStats": [[37, 5, 1, "", "cpu_percent"], [37, 5, 1, "", "cpu_swap_percent"], [37, 5, 1, "", "cpu_vm_percent"], [37, 5, 1, "", "worker_cpu_time_system"], [37, 5, 1, "", "worker_cpu_time_user"], [37, 5, 1, "", "worker_rss"]], "torchtnt.utils.DDPStrategy": [[37, 5, 1, "", "broadcast_buffers"], [37, 5, 1, "", "bucket_cap_mb"], [37, 5, 1, "", "check_reduction"], [37, 5, 1, "", "comm_hook"], [37, 5, 1, "", "comm_state"], [37, 5, 1, "", "dim"], [37, 5, 1, "", "find_unused_parameters"], [37, 5, 1, "", "gradient_as_bucket_view"], [37, 5, 1, "", "output_device"], [37, 5, 1, "", "process_group"], [37, 5, 1, "", "static_graph"], [37, 5, 1, "", "sync_batchnorm"]], "torchtnt.utils.EarlyStopChecker": [[37, 1, 1, "", "check"], [37, 3, 1, "", "check_finite"], [37, 3, 1, "", "divergence_threshold"], [37, 1, 1, "", "load_state_dict"], [37, 3, 1, "", "min_delta"], [37, 3, 1, "", "mode"], [37, 3, 1, "", "patience"], [37, 1, 1, "", "reset"], [37, 1, 1, "", "state_dict"], [37, 3, 1, "", "stopping_threshold"], [37, 3, 1, "", "threshold_mode"]], "torchtnt.utils.FSDPStrategy": [[37, 5, 1, "", "auto_wrap_policy"], [37, 5, 1, "", "backward_prefetch"], [37, 5, 1, "", "cpu_offload"], [37, 5, 1, "", "forward_prefetch"], [37, 5, 1, "", "ignored_modules"], [37, 5, 1, "", "limit_all_gathers"], [37, 5, 1, "", "mixed_precision"], [37, 5, 1, "", "optim_state_dict_config"], [37, 5, 1, "", "process_group"], [37, 5, 1, "", "sharding_strategy"], [37, 5, 1, "", "state_dict_config"], [37, 5, 1, "", "state_dict_type"], [37, 5, 1, "", "sync_module_states"], [37, 5, 1, "", "use_orig_params"]], "torchtnt.utils.FlopTensorDispatchMode": [[37, 1, 1, "", "reset"]], "torchtnt.utils.FullSyncPeriodicTimer": [[37, 1, 1, "", "check"]], "torchtnt.utils.GPUStats": [[37, 5, 1, "", "fan_speed_percent"], [37, 5, 1, "", "memory_free_mb"], [37, 5, 1, "", "memory_used_mb"], [37, 5, 1, "", "temperature_gpu_celsius"], [37, 5, 1, "", "temperature_memory_celsius"], [37, 5, 1, "", "utilization_gpu_percent"], [37, 5, 1, "", "utilization_memory_percent"]], "torchtnt.utils.ModuleSummary": [[37, 3, 1, "", "flops_backward"], [37, 3, 1, "", "flops_forward"], [37, 3, 1, "", "forward_elapsed_time_ms"], [37, 3, 1, "", "has_uninitialized_param"], [37, 3, 1, "", "in_size"], [37, 3, 1, "", "module_name"], [37, 3, 1, "", "module_type"], [37, 3, 1, "", "num_parameters"], [37, 3, 1, "", "num_trainable_parameters"], [37, 3, 1, "", "out_size"], [37, 3, 1, "", "size_bytes"], [37, 3, 1, "", "submodule_summaries"]], "torchtnt.utils.PGWrapper": [[37, 1, 1, "", "all_gather_object"], [37, 1, 1, "", "barrier"], [37, 1, 1, "", "broadcast_object_list"], [37, 1, 1, "", "get_rank"], [37, 1, 1, "", "get_world_size"], [37, 1, 1, "", "scatter_object_list"]], "torchtnt.utils.Progress": [[37, 1, 1, "", "increment_epoch"], [37, 1, 1, "", "increment_step"], [37, 1, 1, "", "load_state_dict"], [37, 3, 1, "", "num_epochs_completed"], [37, 3, 1, "", "num_steps_completed"], [37, 3, 1, "", "num_steps_completed_in_epoch"], [37, 1, 1, "", "state_dict"]], "torchtnt.utils.RSSProfiler": [[37, 5, 1, "", "interval"], [37, 1, 1, "", "profile"], [37, 1, 1, "", "reset"], [37, 5, 1, "", "rss_deltas_bytes"]], "torchtnt.utils.Stateful": [[37, 1, 1, "", "load_state_dict"], [37, 1, 1, "", "state_dict"]], "torchtnt.utils.Timer": [[37, 1, 1, "", "reset"], [37, 1, 1, "", "time"]], "torchtnt.utils.data": [[25, 0, 1, "", "AllDatasetBatchesIterator"], [26, 0, 1, "", "CudaDataPrefetcher"], [27, 0, 1, "", "InOrderIterator"], [28, 0, 1, "", "MultiDataLoader"], [29, 0, 1, "", "MultiIterator"], [30, 0, 1, "", "RandomizedBatchSamplerIterator"], [31, 0, 1, "", "RoundRobinIterator"]], "torchtnt.utils.data.MultiDataLoader": [[28, 5, 1, "", "ignore_empty_data"], [28, 5, 1, "", "individual_dataloaders"], [28, 5, 1, "", "iteration_strategy"], [28, 5, 1, "", "iterator_cls"], [28, 1, 1, "", "load_state_dict"], [28, 1, 1, "", "state_dict"]], "torchtnt.utils.loggers": [[32, 0, 1, "", "CSVLogger"], [36, 0, 1, "", "FileLogger"], [33, 0, 1, "", "InMemoryLogger"], [34, 0, 1, "", "JSONLogger"], [36, 0, 1, "", "MetricLogger"], [35, 0, 1, "", "TensorBoardLogger"]], "torchtnt.utils.loggers.CSVLogger": [[32, 1, 1, "", "close"]], "torchtnt.utils.loggers.FileLogger": [[36, 1, 1, "", "close"], [36, 1, 1, "", "flush"], [36, 1, 1, "", "log"], [36, 1, 1, "", "log_dict"], [36, 3, 1, "", "path"]], "torchtnt.utils.loggers.InMemoryLogger": [[33, 1, 1, "", "close"], [33, 1, 1, "", "log"], [33, 3, 1, "", "log_buffer"], [33, 1, 1, "", "log_dict"]], "torchtnt.utils.loggers.JSONLogger": [[34, 1, 1, "", "close"]], "torchtnt.utils.loggers.MetricLogger": [[36, 1, 1, "", "close"], [36, 1, 1, "", "log"], [36, 1, 1, "", "log_dict"]], "torchtnt.utils.loggers.TensorBoardLogger": [[35, 1, 1, "", "close"], [35, 1, 1, "", "flush"], [35, 1, 1, "", "log"], [35, 1, 1, "", "log_audio"], [35, 1, 1, "", "log_dict"], [35, 1, 1, "", "log_hparams"], [35, 1, 1, "", "log_image"], [35, 1, 1, "", "log_images"], [35, 1, 1, "", "log_scalars"], [35, 1, 1, "", "log_text"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:module", "3": "py:property", "4": "py:function", "5": "py:attribute"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "module", "Python module"], "3": ["py", "property", "Python property"], "4": ["py", "function", "Python function"], "5": ["py", "attribute", "Python attribute"]}, "titleterms": {"checkpoint": 0, "distribut": 1, "train": [1, 2, 21], "data": [1, 24], "parallel": 1, "fulli": 1, "shard": 1, "exampl": [2, 23], "trainunit": [2, 22], "autounit": [2, 3], "torchdata": 2, "mnist": 2, "mingpt": 2, "torchrec": 2, "callback": 4, "built": [4, 36], "evalu": 5, "entri": [5, 6, 19, 21], "point": [5, 6, 19, 21], "fit": 6, "basecsvwrit": 7, "garbagecollector": 8, "iterationtimelogg": 9, "lambda": 10, "learningratemonitor": 11, "modulesummari": 12, "pytorchprofil": 13, "systemresourcesmonitor": 14, "tqdmprogressbar": 15, "tensorboardparametermonitor": 16, "torchsnapshotsav": 17, "trainprogressmonitor": 18, "predict": 19, "state": 20, "phasest": 20, "unit": 22, "evalunit": 22, "predictunit": 22, "combin": 22, "multipl": 22, "welcom": 23, "torchtnt": 23, "document": 23, "instal": 23, "core": 23, "concept": 23, "framework": 23, "util": [23, 37], "alldatasetbatchesiter": 25, "cudadataprefetch": 26, "inorderiter": 27, "multidataload": 28, "multiiter": 29, "randomizedbatchsampleriter": 30, "roundrobiniter": 31, "csvlogger": 32, "inmemorylogg": 33, "jsonlogg": 34, "tensorboardlogg": 35, "logger": 36}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 56}})