Search.setIndex({"docnames": ["distributed", "examples", "framework/auto_unit", "framework/callbacks", "framework/eval", "framework/fit", "framework/generated/torchtnt.framework.callbacks.BaseCSVWriter", "framework/generated/torchtnt.framework.callbacks.GarbageCollector", "framework/generated/torchtnt.framework.callbacks.Lambda", "framework/generated/torchtnt.framework.callbacks.LearningRateMonitor", "framework/generated/torchtnt.framework.callbacks.ModuleSummary", "framework/generated/torchtnt.framework.callbacks.PyTorchProfiler", "framework/generated/torchtnt.framework.callbacks.SystemResourcesMonitor", "framework/generated/torchtnt.framework.callbacks.TQDMProgressBar", "framework/generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor", "framework/generated/torchtnt.framework.callbacks.TorchSnapshotSaver", "framework/generated/torchtnt.framework.callbacks.TrainProgressMonitor", "framework/predict", "framework/state", "framework/train", "framework/unit", "index", "utils/data", "utils/generated/torchtnt.utils.data.AllDatasetBatchesIterator", "utils/generated/torchtnt.utils.data.CudaDataPrefetcher", "utils/generated/torchtnt.utils.data.InOrderIterator", "utils/generated/torchtnt.utils.data.MultiDataLoader", "utils/generated/torchtnt.utils.data.MultiIterator", "utils/generated/torchtnt.utils.data.RandomizedBatchSamplerIterator", "utils/generated/torchtnt.utils.data.RoundRobinIterator", "utils/generated/torchtnt.utils.loggers.CSVLogger", "utils/generated/torchtnt.utils.loggers.InMemoryLogger", "utils/generated/torchtnt.utils.loggers.JSONLogger", "utils/generated/torchtnt.utils.loggers.TensorBoardLogger", "utils/loggers", "utils/utils"], "filenames": ["distributed.rst", "examples.rst", "framework/auto_unit.rst", "framework/callbacks.rst", "framework/eval.rst", "framework/fit.rst", "framework/generated/torchtnt.framework.callbacks.BaseCSVWriter.rst", "framework/generated/torchtnt.framework.callbacks.GarbageCollector.rst", "framework/generated/torchtnt.framework.callbacks.Lambda.rst", "framework/generated/torchtnt.framework.callbacks.LearningRateMonitor.rst", "framework/generated/torchtnt.framework.callbacks.ModuleSummary.rst", "framework/generated/torchtnt.framework.callbacks.PyTorchProfiler.rst", "framework/generated/torchtnt.framework.callbacks.SystemResourcesMonitor.rst", "framework/generated/torchtnt.framework.callbacks.TQDMProgressBar.rst", "framework/generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor.rst", "framework/generated/torchtnt.framework.callbacks.TorchSnapshotSaver.rst", "framework/generated/torchtnt.framework.callbacks.TrainProgressMonitor.rst", "framework/predict.rst", "framework/state.rst", "framework/train.rst", "framework/unit.rst", "index.rst", "utils/data.rst", "utils/generated/torchtnt.utils.data.AllDatasetBatchesIterator.rst", "utils/generated/torchtnt.utils.data.CudaDataPrefetcher.rst", "utils/generated/torchtnt.utils.data.InOrderIterator.rst", "utils/generated/torchtnt.utils.data.MultiDataLoader.rst", "utils/generated/torchtnt.utils.data.MultiIterator.rst", "utils/generated/torchtnt.utils.data.RandomizedBatchSamplerIterator.rst", "utils/generated/torchtnt.utils.data.RoundRobinIterator.rst", "utils/generated/torchtnt.utils.loggers.CSVLogger.rst", "utils/generated/torchtnt.utils.loggers.InMemoryLogger.rst", "utils/generated/torchtnt.utils.loggers.JSONLogger.rst", "utils/generated/torchtnt.utils.loggers.TensorBoardLogger.rst", "utils/loggers.rst", "utils/utils.rst"], "titles": ["Distributed training", "Examples", "AutoUnit", "Callbacks", "Evaluate", "Fit", "BaseCSVWriter", "GarbageCollector", "Lambda", "LearningRateMonitor", "ModuleSummary", "PyTorchProfiler", "SystemResourcesMonitor", "TQDMProgressBar", "TensorBoardParameterMonitor", "TorchSnapshotSaver", "TrainProgressMonitor", "Predict", "State", "Train", "Unit", "Welcome to the TorchTNT documentation!", "Data", "AllDatasetBatchesIterator", "CudaDataPrefetcher", "InOrderIterator", "MultiDataLoader", "MultiIterator", "RandomizedBatchSamplerIterator", "RoundRobinIterator", "CSVLogger", "InMemoryLogger", "JSONLogger", "TensorBoardLogger", "Loggers", "Utils"], "terms": {"The": [0, 1, 2, 4, 5, 6, 7, 10, 17, 19, 20, 26, 35], "core": [0, 2, 20], "tnt": [0, 1, 21], "framework": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20], "make": [0, 7, 21, 22, 35], "assumpt": 0, "about": [0, 2, 18, 20, 35], "devic": [0, 2, 24, 35], "expect": 0, "user": [0, 2, 11, 15, 18, 20, 24, 34], "handl": [0, 2, 15, 35], "configur": [0, 7], "own": [0, 3, 34], "As": [0, 7, 35], "conveni": [0, 2, 7, 20, 35], "offer": [0, 2, 3, 15, 20, 22, 34], "autounit": [0, 21], "who": [0, 2], "prefer": 0, "thi": [0, 2, 3, 5, 6, 7, 15, 16, 20, 23, 24, 25, 26, 28, 29, 33, 35], "automat": [0, 7], "provid": [0, 6, 15, 25, 26, 27, 28, 35], "checkpoint": [0, 2, 3, 15, 35], "callback": [0, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21], "model": [0, 1, 2, 3, 7, 15, 20, 35], "load": [0, 15, 24, 26, 35], "If": [0, 2, 10, 15, 21, 33, 35], "you": [0, 15, 20, 21, 35], "ar": [0, 2, 3, 15, 20, 21, 23, 25, 26, 27, 28, 29, 30, 34, 35], "us": [0, 1, 2, 3, 4, 5, 10, 11, 15, 17, 18, 19, 20, 24, 28, 33, 34, 35], "trainunit": [0, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 19], "evalunit": [0, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 15], "predictunit": [0, 3, 6, 7, 8, 10, 11, 12, 13, 15, 17], "interfac": [0, 2, 6, 20, 35], "initi": [0, 2, 13, 15, 33, 35], "cuda": [0, 2, 4, 5, 12, 17, 19, 24, 35], "applic": [0, 7, 15, 35], "along": 0, "global": [0, 35], "process": [0, 6, 7, 15, 33, 35], "group": [0, 9, 15, 31, 33, 34, 35], "from": [0, 2, 3, 4, 5, 8, 10, 15, 17, 19, 20, 21, 23, 25, 26, 27, 28, 31, 33, 35], "torch": [0, 2, 4, 5, 11, 14, 15, 17, 19, 20, 23, 24, 25, 28, 29, 35], "we": [0, 3, 7, 22, 24, 34, 35], "function": [0, 2, 3, 8, 10, 20, 26, 27, 35], "init_from_env": [0, 35], "work": [0, 35], "torchelast": 0, "set": [0, 4, 5, 12, 15, 17, 19, 23, 28, 35], "which": [0, 2, 3, 4, 5, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 24, 26, 35], "should": [0, 2, 3, 5, 6, 15, 24, 26, 30, 31, 32, 34, 35], "invok": [0, 35], "begin": [0, 16, 35], "your": [0, 3, 20], "script": [0, 35], "ddp": [0, 2, 35], "can": [0, 1, 2, 3, 4, 5, 7, 15, 17, 18, 19, 20, 21, 22, 24, 25, 27, 28, 29, 33, 34, 35], "simpli": 0, "wrap": [0, 35], "around": [0, 21, 34, 35], "like": [0, 2, 27, 35], "so": [0, 21], "modul": [0, 2, 4, 5, 10, 14, 17, 19, 20, 21, 35], "nn": [0, 2, 20, 35], "linear": [0, 35], "input_dim": 0, "1": [0, 5, 7, 13, 23, 24, 25, 28, 29, 35], "move": [0, 24, 25, 35], "device_id": 0, "index": [0, 27, 35], "distributeddataparallel": [0, 35], "also": [0, 15, 21, 26, 27, 34, 35], "prepare_ddp": [0, 35], "assist": 0, "when": [0, 1, 2, 3, 6, 8, 10, 15, 16, 18, 23, 24, 35], "either": [0, 2, 9, 12, 14, 16, 35], "string": [0, 2, 6, 31, 33, 34, 35], "pass": [0, 2, 3, 26, 30, 33, 35], "strategi": [0, 2, 29, 35], "argument": [0, 4, 5, 17, 19, 33, 35], "my_auto_unit": 0, "myautounit": 0, "dataclass": [0, 23, 25, 26, 27, 28, 29, 35], "ddpstrategi": [0, 35], "help": [0, 16, 22], "want": [0, 10, 15, 20], "custom": [0, 2, 15, 25, 35], "ddp_strategi": 0, "broadcast_buff": [0, 35], "fals": [0, 26, 30, 32, 35], "check_reduct": [0, 35], "true": [0, 2, 15, 30, 32, 34, 35], "one": [0, 2, 6, 20, 25, 29, 35], "more": [0, 1, 2, 15, 24, 26, 27, 35], "fsdp": [0, 2, 15, 35], "fullyshardeddataparallel": [0, 35], "prepare_fsdp": [0, 35], "fsdpstrategi": [0, 35], "fsdp_strategi": 0, "forward_prefetch": [0, 35], "limit_all_gath": [0, 35], "show": 1, "how": [1, 2, 5, 23, 25, 26, 27, 28, 29], "basic": [1, 3, 20], "It": [1, 13, 21, 26, 35], "found": [1, 35], "here": [1, 20, 35], "http": [1, 2, 14, 15, 21, 24, 27, 35], "github": [1, 21], "com": [1, 21], "pytorch": [1, 2, 4, 5, 11, 14, 15, 17, 19, 21, 24, 27, 35], "blob": 1, "master": [1, 21], "train_unit_exampl": 1, "py": 1, "less": [1, 35], "code": [1, 2, 3, 7, 11, 20, 35], "featur": 1, "enabl": [1, 2, 35], "out": [1, 3, 34, 35], "box": [1, 3, 34], "auto_unit_exampl": 1, "s": [1, 2, 4, 5, 7, 15, 17, 19, 20, 26, 35], "datapip": 1, "dataloader2": [1, 4, 5, 17, 19], "torchdata_train_exampl": 1, "convnet": 1, "dataset": [1, 16, 23, 25, 28, 29], "main": [1, 15, 21], "class": [2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18, 20, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35], "torchtnt": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35], "auto_unit": 2, "arg": [2, 8, 10, 33, 34, 35], "kwarg": [2, 10, 33, 34, 35], "train": [2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 20, 21, 33, 35], "stochast": 2, "gradient": [2, 7], "descent": 2, "would": 2, "have": [2, 15, 35], "optim": [2, 4, 5, 9, 17, 19, 20], "data": [2, 4, 5, 16, 17, 19, 20, 21, 23, 24, 25, 26, 27, 28, 29, 31, 33, 34, 35], "parallel": 2, "replic": [2, 15], "them": [2, 24], "subclass": [2, 3, 5, 20, 26, 34], "implement": [2, 4, 5, 6, 17, 19, 20, 26, 35], "train_step": [2, 5, 19, 20], "eval_step": [2, 4, 5, 20], "method": [2, 15, 20, 35], "For": [2, 15, 26, 27, 35], "run": [2, 4, 5, 7, 8, 17, 18, 19, 20, 21, 35], "forward": [2, 35], "loss": [2, 20], "comput": [2, 24], "backward": [2, 20, 35], "step": [2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 15, 16, 17, 18, 19, 20, 30, 31, 32, 33, 34, 35], "onli": [2, 13, 18, 26, 30, 32, 33, 34, 35], "To": [2, 3, 20, 21, 35], "benefit": 2, "must": [2, 6, 7, 33, 35], "compute_loss": 2, "configure_optimizers_and_lr_schedul": 2, "addition": [2, 35], "option": [2, 3, 4, 5, 8, 10, 15, 17, 18, 19, 20, 26, 30, 32, 35], "hook": [2, 3, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16, 20, 35], "on_train_step_end": [2, 3, 5, 7, 8, 11, 13, 15, 19], "on_eval_step_end": [2, 3, 4, 7, 8, 11, 13], "Then": [2, 20], "evalu": [2, 3, 5, 7, 8, 10, 11, 13, 15, 18, 20, 21], "fit": [2, 3, 15, 18, 20, 21], "entri": [2, 3, 15, 18, 35], "point": [2, 3, 7, 18, 20, 35], "normal": 2, "advanc": 2, "directli": [2, 31], "paramet": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 20, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35], "dure": [2, 3, 4, 5, 6, 8, 15, 17, 18, 19, 35], "step_lr_interv": 2, "whether": [2, 12, 18, 35], "lr_schedul": [2, 4, 5, 17, 19, 20], "everi": [2, 7, 12, 16], "epoch": [2, 3, 4, 5, 8, 9, 12, 13, 14, 15, 16, 17, 18, 19, 20, 35], "default": [2, 6, 7, 10, 12, 15, 25, 26, 28, 35], "precis": [2, 35], "dtype": [2, 35], "gradient_accumulation_step": 2, "mani": 2, "batch": [2, 20, 23, 24, 25, 27, 28, 29, 33, 35], "accumul": 2, "over": [2, 23, 25, 26, 27, 28, 29], "detect_anomali": 2, "anomali": 2, "detect": 2, "autograd": 2, "engin": 2, "org": [2, 14, 15, 24, 27, 35], "doc": [2, 14, 24, 35], "stabl": [2, 14, 24, 35], "html": [2, 14, 15, 24, 27, 35], "clip_grad_norm": 2, "max": [2, 4, 5, 17, 19, 35], "norm": [2, 35], "clip": 2, "gener": [2, 3, 7, 10, 15, 26, 27, 35], "util": [2, 4, 5, 10, 14, 15, 17, 19, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34], "clip_grad_norm_": 2, "clip_grad_valu": 2, "valu": [2, 23, 25, 26, 27, 28, 29, 31, 33, 34, 35], "clip_grad_value_": 2, "swa_param": 2, "param": [2, 35], "weight": [2, 28], "averag": 2, "torch_compile_param": 2, "compil": 2, "activation_checkpoint_param": 2, "activ": [2, 10, 18, 35], "lr": 2, "schedul": [2, 9, 20], "creat": [2, 7, 20, 33, 34, 35], "after": [2, 3, 5, 6, 7, 11, 13, 14, 15, 16, 18, 20, 28, 30, 31, 32, 33, 34, 35], "current": [2, 18, 35], "support": [2, 23, 25, 26, 27, 29, 35], "avail": [2, 15, 35], "2": [2, 23, 24, 25, 28, 29, 35], "0": [2, 13, 15, 23, 25, 28, 29, 30, 32, 33, 34, 35], "higher": 2, "abstract": [2, 20, 21, 22, 34], "state": [2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 20, 21, 26, 35], "tdata": 2, "tupl": [2, 10, 20, 35], "tensor": [2, 20, 23, 25, 28, 29, 31, 33, 34, 35], "ani": [2, 4, 5, 10, 15, 17, 18, 19, 20, 26, 33, 35], "call": [2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 20, 30, 31, 32, 33, 34, 35], "object": [2, 4, 5, 7, 17, 18, 19, 20, 23, 25, 26, 27, 28, 29, 35], "return": [2, 15, 20, 23, 25, 26, 28, 29, 35], "contain": [2, 18, 20, 21, 23, 24, 26, 35], "output": [2, 6, 18, 20, 35], "part": 2, "lrschedul": [2, 35], "learn": [2, 9, 20], "rate": [2, 9, 13, 20], "construct": [2, 24, 33, 35], "upon": 2, "A": [2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18, 23, 25, 26, 27, 28, 29, 35], "requir": [2, 20, 35], "each": [2, 6, 7, 8, 9, 15, 18, 20, 28, 35], "iter": [2, 4, 5, 16, 17, 18, 19, 20, 23, 24, 25, 26, 27, 28, 29, 35], "eval": [2, 3, 4, 5, 7, 8, 11, 12, 13, 15, 17, 18, 20], "dataload": [2, 4, 5, 8, 15, 17, 18, 19, 20, 23, 24, 25, 26, 27, 28, 29, 35], "wish": [2, 20], "decor": [2, 20], "inference_mod": [2, 20], "improv": [2, 7, 20, 35], "perform": [2, 4, 5, 7, 17, 19, 20], "metadata": [2, 20], "move_data_to_devic": 2, "non_block": 2, "bool": [2, 15, 18, 26, 30, 32, 34, 35], "overrid": 2, "copi": [2, 24, 35], "start": [2, 3, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 18, 20, 35], "By": [2, 6, 7, 15, 25, 28, 35], "copy_data_to_devic": [2, 35], "gpu": [2, 12, 35], "separ": [2, 6, 35], "stream": [2, 35], "int": [2, 4, 5, 7, 10, 13, 15, 17, 18, 19, 24, 30, 31, 32, 33, 34, 35], "none": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 26, 30, 31, 32, 33, 34, 35], "end": [2, 3, 6, 7, 8, 11, 13, 14, 15, 16, 18, 20], "befor": [2, 3, 6, 7, 9, 10, 11, 12, 13, 16, 20, 30, 32, 34, 35], "updat": [2, 7, 13, 21], "log": [2, 9, 10, 12, 14, 16, 21, 30, 31, 32, 33, 34, 35], "metric": [2, 21, 33, 34, 35], "do": [2, 21], "anyth": 2, "els": [2, 30, 32, 34], "been": [2, 23, 29, 35], "complet": [2, 15, 18, 35], "on_train_end": [2, 3, 5, 7, 8, 11, 15, 19, 20], "note": [2, 15, 35], "swa": 2, "super": [2, 20], "on_train_epoch_end": [2, 3, 5, 8, 13, 14, 15, 16, 19, 20], "rememb": 2, "autopredictunit": 2, "union": [2, 3, 6, 8, 9, 12, 14, 15, 16, 23, 25, 26, 27, 28, 29, 31, 33, 34, 35], "str": [2, 3, 6, 9, 10, 15, 23, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35], "torchcompileparam": 2, "tpredictdata": [2, 3, 6, 7, 8, 10, 11, 12, 13, 15, 17, 20], "predict_step": [2, 17, 20], "on_predict_step_end": [2, 3, 6, 7, 8, 11, 13, 17], "predict": [2, 3, 6, 7, 8, 10, 11, 12, 13, 18, 20, 21], "an": [3, 4, 5, 6, 7, 8, 9, 11, 13, 15, 17, 19, 20, 24, 26, 35], "extens": 3, "supplement": [3, 15], "loop": [3, 4, 5, 7, 8, 17, 18, 19, 20, 21, 35], "addit": [3, 15, 35], "good": 3, "candid": 3, "logic": [3, 20, 26, 27], "ones": 3, "re": [3, 35], "across": [3, 6, 7, 15, 16, 35], "unit": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 21], "intend": [3, 35], "go": 3, "write": [3, 6, 16, 30, 32, 33, 34, 35], "add": [3, 31, 33, 34, 35], "below": [3, 4, 5, 17, 19, 20], "exampl": [3, 4, 5, 8, 17, 19, 20, 23, 24, 25, 26, 27, 28, 29, 31, 33, 35], "print": [3, 8, 10, 12, 23, 25, 28, 29, 35], "messag": [3, 35], "variou": [3, 21], "execut": [3, 4, 5, 7, 17, 18, 19, 35], "import": [3, 4, 5, 7, 8, 17, 19, 20, 31, 33, 35], "tevalunit": 3, "tpredictunit": 3, "ttrainunit": 3, "printingcallback": 3, "def": [3, 8, 20], "on_train_start": [3, 5, 7, 8, 10, 11, 15, 16, 19, 20], "self": [3, 20], "on_eval_start": [3, 4, 7, 8, 10, 11, 20], "on_eval_end": [3, 4, 7, 8, 11, 20], "on_predict_start": [3, 6, 7, 8, 10, 11, 17, 20], "on_predict_end": [3, 6, 7, 8, 11, 17, 20], "instanti": 3, "printing_callback": 3, "train_unit": [3, 19, 20], "train_dataload": [3, 5, 15, 19], "properti": [3, 15, 18, 31, 34, 35], "name": [3, 6, 10, 15, 23, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35], "distinct": 3, "per": [3, 4, 5, 17, 18, 19], "instanc": [3, 4, 5, 14, 17, 18, 19, 26, 35], "debug": [3, 18], "profil": [3, 11, 35], "purpos": 3, "tevaldata": [3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 15, 20], "on_eval_epoch_end": [3, 4, 8, 13, 20], "on_eval_epoch_start": [3, 4, 8, 12, 13, 20], "new": [3, 9, 12, 13, 20, 33], "on_eval_step_start": [3, 4, 8, 12], "on_except": [3, 6, 8, 15], "ttraindata": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 19, 20], "exc": [3, 6, 15], "baseexcept": [3, 6, 8, 15, 35], "except": [3, 4, 5, 6, 8, 15, 17, 19, 26, 35], "occur": [3, 6, 8, 15, 16, 35], "on_predict_epoch_end": [3, 8, 13, 17, 20], "on_predict_epoch_start": [3, 8, 12, 13, 17, 20], "on_predict_step_start": [3, 8, 12, 17], "on_train_epoch_start": [3, 5, 8, 9, 12, 13, 19, 20], "on_train_step_start": [3, 5, 8, 9, 12, 19], "sever": [3, 20, 22, 35], "pre": 3, "written": [3, 6, 30, 31, 32, 33, 34], "readi": 3, "eval_unit": [4, 20], "eval_dataload": [4, 5], "max_steps_per_epoch": [4, 17, 18, 19, 35], "list": [4, 5, 6, 9, 10, 12, 15, 16, 17, 19, 35], "timer": [4, 5, 17, 18, 19, 35], "timerprotocol": [4, 5, 17, 18, 19, 35], "take": [4, 5, 7, 15, 17, 19], "modifi": [4, 5, 17, 18, 19], "includ": [4, 5, 12, 17, 19, 21, 26, 27, 35], "etc": [4, 5, 10, 17, 19, 26, 27], "number": [4, 5, 7, 13, 15, 17, 18, 19, 24, 30, 32, 34, 35], "mean": [4, 5, 17, 19, 35], "until": [4, 5, 17, 19, 23], "exhaust": [4, 5, 17, 19, 23, 25, 28, 29], "time": [4, 5, 7, 17, 19, 30, 35], "kei": [4, 5, 15, 17, 18, 19, 23, 25, 26, 27, 28, 29, 35], "event": [4, 5, 17, 18, 19, 33, 35], "synchron": [4, 5, 7, 17, 19, 33, 35], "mai": [4, 5, 17, 19, 35], "degrad": [4, 5, 17, 19], "myevalunit": [4, 20], "20": [4, 17], "pseudocod": [4, 5, 17, 19], "what": [4, 5, 17, 19, 35], "doe": [4, 5, 7, 17, 19, 35], "track": [4, 5, 9, 17, 19, 35], "mode": [4, 5, 17, 19, 35], "first": [4, 5, 17, 19, 21], "while": [4, 5, 17, 19, 23, 29, 34], "done": [4, 5, 17, 19, 23, 29, 35], "try": [4, 5, 17, 19], "next": [4, 5, 17, 19, 25], "increment": [4, 5, 17, 19, 35], "counter": [4, 5, 17, 19, 35], "stopiter": [4, 5, 17, 19], "break": [4, 5, 17, 19], "max_epoch": [5, 18, 19], "max_step": [5, 18, 19, 35], "max_train_steps_per_epoch": 5, "max_eval_steps_per_epoch": 5, "evaluate_every_n_step": [5, 18], "evaluate_every_n_epoch": [5, 18], "interleav": [5, 20, 24], "both": 5, "limit": [5, 19], "infinit": [5, 19, 35], "unless": [5, 19], "stop": [5, 18, 19, 23, 28, 29, 35], "often": 5, "term": [5, 16, 18], "fit_unit": 5, "myfitunit": 5, "4": [5, 19, 23, 25, 28, 29, 35], "header_row": 6, "dir_path": 6, "delimit": 6, "t": [6, 35], "filenam": 6, "csv": [6, 30], "file": [6, 30, 32, 33, 34, 35], "simplifi": [6, 21, 34], "extend": [6, 20], "get_step_output_row": 6, "desir": 6, "row": 6, "all": [6, 7, 10, 15, 23, 25, 27, 28, 30, 32, 34, 35], "same": [6, 7, 15, 20, 25, 26, 27, 35], "match": 6, "column": 6, "defin": [6, 18, 20, 26, 27, 29, 33, 35], "directori": [6, 15, 35], "path": [6, 15, 30, 32, 33, 34, 35], "where": [6, 15, 20, 35], "save": [6, 15, 33, 35], "tab": 6, "step_interv": 7, "period": [7, 15, 35], "garbag": 7, "collect": [7, 15, 33, 35], "In": [7, 20, 35], "fulli": 7, "distribut": [7, 13, 15, 33, 35], "program": [7, 35], "multipl": [7, 31, 33, 34, 35], "These": [7, 20, 35], "need": [7, 20, 35], "commun": [7, 35], "other": [7, 15, 35], "especi": [7, 16], "overal": 7, "therefor": 7, "gate": 7, "slowest": 7, "result": [7, 35], "roughli": 7, "amount": 7, "its": [7, 35], "otherwis": [7, 35], "straggler": 7, "python": [7, 35], "trigger": 7, "differ": [7, 20, 21, 34, 35], "possibl": 7, "lead": 7, "frequenc": [7, 15, 18], "tune": 7, "base": [7, 26, 35], "hand": 7, "free": [7, 35], "up": [7, 18], "some": [7, 20], "reap": 7, "minim": 7, "overhead": 7, "compar": 7, "full": 7, "callabl": [8, 10, 35], "accept": 8, "mydataload": 8, "myunit": [8, 20], "print_on_step_start": 8, "f": [8, 35], "eval_progress": 8, "num_steps_complet": [8, 35], "lambda_cb": 8, "logger": [9, 12, 14, 16, 21, 30, 31, 32, 33, 35], "metriclogg": [9, 12, 16, 34], "logging_interv": [9, 12], "associ": 9, "max_depth": [10, 35], "type": [10, 15, 20, 26, 35], "process_fn": 10, "module_summari": [10, 35], "_log_module_summary_t": 10, "module_input": [10, 35], "mutablemap": [10, 35], "dict": [10, 15, 23, 25, 26, 31, 33, 34, 35], "summari": [10, 33, 35], "maximum": [10, 18, 35], "depth": [10, 35], "keep": [10, 35], "tabl": 10, "map": [10, 23, 25, 27, 28, 29, 31, 33, 34, 35], "flop": [10, 35], "size": [10, 12, 35], "rais": [10, 26, 35], "runtimeerror": [10, 35], "torchev": [10, 35], "instal": 10, "context": [11, 35], "manag": [11, 15, 35], "liter": [12, 35], "system": [12, 35], "stat": [12, 35], "cpu": [12, 35], "usag": 12, "resid": [12, 35], "memori": [12, 24, 31, 35], "refresh_r": [13, 35], "progress": [13, 15, 16, 35], "bar": 13, "visual": [13, 16, 35], "rank": [13, 15, 30, 32, 33, 34, 35], "environ": [13, 33, 35], "determin": [13, 35], "get": [13, 27, 35], "tensorboardlogg": 14, "summarywrit": [14, 33], "histogram": 14, "tensorboard": [14, 33], "writer": [14, 33], "dirpath": 15, "save_every_n_train_step": 15, "save_every_n_epoch": 15, "storage_opt": 15, "torchsnapshot": 15, "appstatemixin": 15, "random": [15, 35], "under": [15, 20, 35], "epoch_": 15, "_step_": 15, "total": [15, 35], "parent": [15, 18], "snapshot": [15, 35], "intra": 15, "glob": 15, "pattern": 15, "indic": [15, 23, 25, 26, 27, 28, 29, 35], "inform": [15, 18, 35], "see": [15, 35], "api_refer": 15, "keyword": [15, 33, 35], "storag": 15, "plugin": 15, "document": [15, 26, 27], "constructor": 15, "oper": [15, 24, 33, 35], "broadcast": [15, 35], "state_dict": [15, 26, 35], "set_state_dict_typ": 15, "prior": 15, "static": 15, "get_latest_checkpoint_path": 15, "given": [15, 27, 35], "latest": [15, 21], "subdirectori": 15, "valid": 15, "collis": 15, "app": [15, 35], "restor": [15, 35], "restore_train_progress": 15, "restore_eval_progress": 15, "sinc": 15, "There": 15, "flag": 15, "skip": [15, 23, 26, 29], "vs": [16, 35], "predict_unit": [17, 20], "predict_dataload": 17, "mypredictunit": [17, 20], "entry_point": 18, "entrypoint": 18, "train_stat": 18, "eval_st": 18, "predict_st": 18, "3": [18, 23, 25, 28, 29, 35], "phase": [18, 20], "read": [18, 26, 27], "active_phas": 18, "activephas": 18, "One": 18, "meta": 18, "should_stop": 18, "termin": 18, "signal": [18, 35], "record": [18, 31, 33, 34, 35], "latenc": 18, "step_output": 18, "last": 18, "mytrainunit": [19, 20], "concept": 20, "repres": [20, 35], "primari": 20, "place": 20, "organ": 20, "three": [20, 23], "mutual": 20, "exclus": 20, "e": [20, 35], "g": [20, 35], "case": [20, 35], "allow": [20, 35], "control": [20, 35], "behavior": 20, "simpl": [20, 31, 33], "specifi": [20, 35], "typecheck": 20, "__init__": 20, "_lrschedul": 20, "input": [20, 25, 35], "target": 20, "binary_cross_entropy_with_logit": 20, "zero_grad": 20, "plan": 20, "refer": [20, 26, 27, 35], "my_unit": 20, "librari": [21, 35], "tool": [21, 35], "ha": [21, 23, 26, 27, 29, 35], "two": [21, 29, 35], "compon": 21, "top": 21, "level": 21, "repo": 21, "lightweight": 21, "maintain": 21, "grab": 21, "bag": 21, "independ": 21, "relat": [21, 22, 35], "wrapper": [21, 34, 35], "publish": [21, 34], "pip": 21, "issu": [21, 35], "sure": 21, "version": [21, 35], "just": 21, "git": 21, "upgrad": 21, "alldatasetbatchesiter": 21, "cudadataprefetch": 21, "inorderiter": 21, "multidataload": 21, "multiiter": [21, 26], "randomizedbatchsampleriter": [21, 25], "roundrobiniter": 21, "built": 21, "prepar": 22, "easier": 22, "individual_dataload": [23, 25, 26, 27, 28, 29], "iteration_strategi": [23, 25, 26, 27, 28, 29], "alldatasetbatch": 23, "mechan": [23, 28, 29], "all_datasets_exhaust": [23, 28, 29], "finish": 23, "till": [23, 25, 29], "largest": [23, 29], "those": [23, 29], "smallest_dataset_exhaust": [23, 29], "onc": [23, 29, 35], "smallest": [23, 29], "restart_until_all_datasets_exhaust": 23, "restart": 23, "format": [23, 25, 28, 29], "dataloader_1_nam": 23, "batch_obtained_from_dataloader_1": 23, "dataloader_2_nam": 23, "batch_obtained_from_dataloader_2": 23, "loader": [23, 25, 28, 29], "rang": [23, 25, 28, 29, 35], "batch_siz": [23, 25, 28, 29], "b": [23, 25, 28, 29], "15": [23, 25, 28, 29], "5": [23, 25, 28, 29, 35], "all_dataset_batch_strategi": 23, "stopping_mechan": [23, 28, 29], "stoppingmechan": [23, 28, 29], "combined_iter": [23, 25, 28, 29], "item": [23, 25, 28, 29], "6": [23, 25, 28, 29], "7": [23, 25, 28, 29], "8": [23, 25, 28, 29, 35], "9": [23, 25, 28, 29], "10": [23, 25, 28, 29, 31, 33], "11": [23, 25, 28, 29], "12": [23, 25, 28, 29, 35], "13": [23, 25, 28, 29, 35], "14": [23, 25, 28, 29], "data_iter": 24, "num_prefetch_batch": 24, "prefetch": 24, "host": [24, 35], "effect": 24, "recommend": 24, "leverag": 24, "pin": 24, "data_prefetch": 24, "alreadi": [24, 35], "inord": 25, "singl": [25, 35], "order": [25, 27, 29, 35], "overridden": 25, "repetit": 25, "dataloader_nam": [25, 28, 29], "batch_from_dataload": [25, 28, 29], "randomizedbatchsampl": [25, 28], "in_order_strategi": 25, "dataiterationstrategi": [26, 27], "iterator_cl": 26, "ignore_empty_data": 26, "cycl": [26, 27, 29], "through": 26, "individu": [26, 27], "dictionari": [26, 31, 33, 34], "torchdata": [26, 27], "multi": [26, 27], "sourc": [26, 27, 35], "achiev": [26, 27], "mux": [26, 27], "mux_longest": [26, 27], "zip": [26, 27], "pleas": [26, 27, 35], "detail": [26, 27, 35], "load_state_dict": [26, 35], "aggreg": 26, "off": 26, "protocol": [26, 35], "accompani": 27, "particular": 27, "beta": 27, "randomli": 28, "sampl": 28, "chang": [28, 35], "anoth": 28, "randomized_batch_sampl": 28, "roundrobin": 29, "via": 29, "robinrobin": 29, "round_robin_strategi": 29, "steps_before_flush": [30, 32, 34], "100": [30, 32], "log_all_rank": [30, 32, 34], "header": 30, "buffer": [30, 31], "flush": [30, 31, 32, 33, 34], "close": [30, 31, 32, 33, 34], "resourc": [30, 31, 32, 34], "necessari": [30, 31, 32, 34], "accuraci": [31, 33], "23": [31, 33], "56": [31, 33], "ndarrai": [31, 33, 34], "float": [31, 33, 34, 35], "scalar": [31, 33, 34], "uniqu": [31, 34], "log_buff": 31, "access": 31, "log_dict": [31, 33, 34], "payload": [31, 33, 34], "tag": [31, 33, 34], "json": 32, "store": [32, 34, 35], "On": 33, "variabl": [33, 35], "extra": 33, "posit": [33, 35], "tmp": 33, "tb_log": 33, "pend": 33, "disk": 33, "cannot": 33, "log_audio": 33, "audio": 33, "add_audio": 33, "log_hparam": 33, "hparam": 33, "hyperparamet": 33, "correspond": [33, 35], "log_imag": 33, "imag": 33, "add_imag": 33, "log_text": 33, "text": 33, "identifi": 33, "filelogg": 34, "abov": 34, "follow": [34, 35], "cpustat": 35, "cpu_perc": 35, "cpu_swap_perc": 35, "cpu_vm_perc": 35, "worker_cpu_time_system": 35, "worker_cpu_time_us": 35, "worker_rss": 35, "output_devic": 35, "dim": 35, "process_group": 35, "processgroup": 35, "bucket_cap_mb": 35, "25": 35, "find_unused_paramet": 35, "gradient_as_bucket_view": 35, "static_graph": 35, "comm_stat": 35, "comm_hook": 35, "gradbucket": 35, "futur": 35, "sync_batchnorm": 35, "regist": 35, "sync": 35, "earlystopcheck": 35, "min": 35, "patienc": 35, "min_delta": 35, "check_finit": 35, "threshold_mod": 35, "ab": 35, "rel": 35, "stopping_threshold": 35, "divergence_threshold": 35, "monitor": 35, "earli": 35, "decreas": 35, "increas": 35, "check": 35, "without": 35, "minimum": 35, "absolut": 35, "qualifi": 35, "improvement_threshold": 35, "best_val": 35, "threshold": 35, "becom": 35, "nan": 35, "delta": 35, "between": 35, "beyond": 35, "wors": 35, "than": 35, "valueerror": 35, "val": 35, "element": 35, "boolean": 35, "reset": 35, "back": 35, "reload": 35, "sharding_strategi": 35, "shardingstrategi": 35, "cpu_offload": 35, "cpuoffload": 35, "auto_wrap_polici": 35, "backward_prefetch": 35, "backwardprefetch": 35, "backward_pr": 35, "ignored_modul": 35, "sync_module_st": 35, "use_orig_param": 35, "state_dict_typ": 35, "statedicttyp": 35, "state_dict_config": 35, "statedictconfig": 35, "optim_state_dict_config": 35, "optimstatedictconfig": 35, "floptensordispatchmod": 35, "measur": 35, "count": 35, "dev": 35, "discuss": 35, "ideal": 35, "dispatch": 35, "505": 35, "torchvis": 35, "resnet18": 35, "randn": 35, "224": 35, "ftdm": 35, "flops_forward": 35, "deepcopi": 35, "flop_count": 35, "flops_backward": 35, "fullsyncperiodictim": 35, "interv": 35, "timedelta": 35, "cpu_pg": 35, "elaps": 35, "propag": 35, "asynchron": 35, "previou": 35, "avoid": 35, "block": 35, "gpustat": 35, "fan_speed_perc": 35, "memory_free_mb": 35, "memory_used_mb": 35, "temperature_gpu_celsiu": 35, "temperature_memory_celsiu": 35, "utilization_gpu_perc": 35, "utilization_memory_perc": 35, "modulesummari": 35, "submodul": 35, "trainabl": 35, "estim": 35, "byte": 35, "uniniti": 35, "calcul": 35, "shape": 35, "ms": 35, "forward_elapsed_time_m": 35, "has_uninitialized_param": 35, "in_siz": 35, "module_nam": 35, "module_typ": 35, "num_paramet": 35, "num_trainable_paramet": 35, "requires_grad": 35, "out_siz": 35, "size_byt": 35, "submodule_summari": 35, "travers": 35, "pgwrapper": 35, "pg": 35, "consist": 35, "fashion": 35, "regardless": 35, "scenario": 35, "world": 35, "all_gather_object": 35, "obj_list": 35, "obj": 35, "barrier": 35, "broadcast_object_list": 35, "src": 35, "get_rank": 35, "get_world_s": 35, "scatter_object_list": 35, "output_list": 35, "input_list": 35, "num_epochs_complet": 35, "num_steps_completed_in_epoch": 35, "increment_epoch": 35, "within": 35, "increment_step": 35, "accord": 35, "thu": 35, "far": 35, "rssprofil": 35, "datetim": 35, "microsecond": 35, "100000": 35, "rss": 35, "baselin": 35, "rss_deltas_byt": 35, "100m": 35, "round": 35, "captur": 35, "thread": 35, "empti": 35, "tlrschedul": 35, "alia": 35, "cuda_sync": 35, "verbos": 35, "recorded_dur": 35, "action_nam": 35, "enclos": 35, "all_gather_tensor": 35, "gather": 35, "onto": 35, "dimens": 35, "pad": 35, "trim": 35, "secur": 35, "equal": 35, "workload": 35, "gathered_result": 35, "i": 35, "attach_oom_observ": 35, "output_dir": 35, "trace_max_entri": 35, "1000000": 35, "attach": 35, "error": 35, "blog": 35, "post": 35, "trace": 35, "granular": 35, "close_progress_bar": 35, "progress_bar": 35, "tqdm_asyncio": 35, "recurs": 35, "correct": 35, "create_progress_bar": 35, "desc": 35, "days_to_sec": 35, "dai": 35, "convert": 35, "second": 35, "get_device_from_env": 35, "reli": 35, "local_rank": 35, "made": 35, "launcher": 35, "appropri": 35, "outsid": 35, "get_filesystem": 35, "abstractfilesystem": 35, "filesystem": 35, "get_global_rank": 35, "env": 35, "var": 35, "instead": 35, "neither": 35, "condit": 35, "met": 35, "get_local_rank": 35, "popul": 35, "elast": 35, "get_module_summari": 35, "module_arg": 35, "module_kwarg": 35, "assign": 35, "tree": 35, "summar": 35, "greater": 35, "lazi": 35, "NOT": 35, "todo": 35, "flexibl": 35, "get_nvidia_smi_gpu_stat": 35, "nvidia": 35, "smi": 35, "filenotfounderror": 35, "command": 35, "get_process_group_backend_from_devic": 35, "backend": 35, "get_psutil_cpu_stat": 35, "psutil": 35, "get_python_vers": 35, "runtim": 35, "get_summary_t": 35, "human_readable_num": 35, "summary_t": 35, "tabular": 35, "exact": 35, "1234": 35, "k": 35, "get_tensor_size_bytes_map": 35, "get_timer_summari": 35, "action": 35, "get_torch_vers": 35, "world_siz": 35, "device_typ": 35, "dist_init_method_typ": 35, "tcp": 35, "pg_backend": 35, "pg_timeout": 35, "1800": 35, "float32_matmul_precis": 35, "high": 35, "launch": 35, "spmd": 35, "style": 35, "timeout": 35, "against": 35, "30": 35, "minut": 35, "matrix": 35, "is_out_of_cpu_memori": 35, "oom": 35, "is_out_of_cuda_memori": 35, "is_out_of_memory_error": 35, "due": 35, "is_torch_version_ge_1_13_1": 35, "is_torch_version_geq_1_10": 35, "is_torch_version_geq_1_11": 35, "is_torch_version_geq_1_12": 35, "is_torch_version_geq_1_13": 35, "is_torch_version_geq_1_14": 35, "is_torch_version_geq_1_8": 35, "is_torch_version_geq_1_9": 35, "is_torch_version_geq_2_0": 35, "is_window": 35, "Is": 35, "window": 35, "log_elapsed_tim": 35, "being": 35, "most": 35, "accur": 35, "log_memory_snapshot": 35, "maybe_enable_tf32": 35, "condition": 35, "float32": 35, "datatyp": 35, "measure_rss_delta": 35, "rss_delta": 35, "append": 35, "api": 35, "ddp_modul": 35, "fsdp_modul": 35, "prune_module_summari": 35, "prune": 35, "deeper": 35, "prun": 35, "inplac": 35, "root": 35, "rank_zero_crit": 35, "rank_zero_debug": 35, "rank_zero_error": 35, "rank_zero_info": 35, "rank_zero_print": 35, "rank_zero_warn": 35, "record_data_in_stream": 35, "mention": 35, "record_stream": 35, "cach": 35, "alloc": 35, "freed": 35, "reus": 35, "newli": 35, "still": 35, "wa": 35, "tell": 35, "might": 35, "underli": 35, "longer": 35, "creator": 35, "notabl": 35, "trick": 35, "seed": 35, "determinist": 35, "pseudo": 35, "commonli": 35, "numpi": 35, "integ": 35, "don": 35, "warn": 35, "nondeterminist": 35, "cudnn": 35, "benchmark": 35, "disabl": 35, "set_deterministic_debug_mod": 35, "algorithm": 35, "sync_bool": 35, "coherence_mod": 35, "rank_zero": 35, "member": 35, "manner": 35, "receiv": 35, "truth": 35, "n": 35, "least": 35, "ratio": 35, "synced_v": 35, "iff": 35, "success": 35, "transfer_batch_norm_stat": 35, "src_modul": 35, "dst_modul": 35, "transfer": 35, "statist": 35, "transfer_weight": 35, "update_progress_bar": 35}, "objects": {"torchtnt.framework.auto_unit": [[2, 0, 1, "", "AutoPredictUnit"], [2, 0, 1, "", "AutoUnit"]], "torchtnt.framework.auto_unit.AutoPredictUnit": [[2, 1, 1, "", "move_data_to_device"], [2, 1, 1, "", "on_predict_step_end"], [2, 1, 1, "", "predict_step"]], "torchtnt.framework.auto_unit.AutoUnit": [[2, 1, 1, "", "compute_loss"], [2, 1, 1, "", "configure_optimizers_and_lr_scheduler"], [2, 1, 1, "", "eval_step"], [2, 1, 1, "", "move_data_to_device"], [2, 1, 1, "", "on_eval_step_end"], [2, 1, 1, "", "on_train_end"], [2, 1, 1, "", "on_train_epoch_end"], [2, 1, 1, "", "on_train_step_end"], [2, 1, 1, "", "train_step"]], "torchtnt.framework": [[3, 2, 0, "-", "callback"]], "torchtnt.framework.callback": [[3, 0, 1, "", "Callback"]], "torchtnt.framework.callback.Callback": [[3, 3, 1, "", "name"], [3, 1, 1, "", "on_eval_end"], [3, 1, 1, "", "on_eval_epoch_end"], [3, 1, 1, "", "on_eval_epoch_start"], [3, 1, 1, "", "on_eval_start"], [3, 1, 1, "", "on_eval_step_end"], [3, 1, 1, "", "on_eval_step_start"], [3, 1, 1, "", "on_exception"], [3, 1, 1, "", "on_predict_end"], [3, 1, 1, "", "on_predict_epoch_end"], [3, 1, 1, "", "on_predict_epoch_start"], [3, 1, 1, "", "on_predict_start"], [3, 1, 1, "", "on_predict_step_end"], [3, 1, 1, "", "on_predict_step_start"], [3, 1, 1, "", "on_train_end"], [3, 1, 1, "", "on_train_epoch_end"], [3, 1, 1, "", "on_train_epoch_start"], [3, 1, 1, "", "on_train_start"], [3, 1, 1, "", "on_train_step_end"], [3, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks": [[6, 0, 1, "", "BaseCSVWriter"], [7, 0, 1, "", "GarbageCollector"], [8, 0, 1, "", "Lambda"], [9, 0, 1, "", "LearningRateMonitor"], [10, 0, 1, "", "ModuleSummary"], [11, 0, 1, "", "PyTorchProfiler"], [12, 0, 1, "", "SystemResourcesMonitor"], [13, 0, 1, "", "TQDMProgressBar"], [14, 0, 1, "", "TensorBoardParameterMonitor"], [15, 0, 1, "", "TorchSnapshotSaver"], [16, 0, 1, "", "TrainProgressMonitor"]], "torchtnt.framework.callbacks.BaseCSVWriter": [[6, 1, 1, "", "on_exception"], [6, 1, 1, "", "on_predict_end"], [6, 1, 1, "", "on_predict_start"], [6, 1, 1, "", "on_predict_step_end"]], "torchtnt.framework.callbacks.GarbageCollector": [[7, 1, 1, "", "on_eval_end"], [7, 1, 1, "", "on_eval_start"], [7, 1, 1, "", "on_eval_step_end"], [7, 1, 1, "", "on_predict_end"], [7, 1, 1, "", "on_predict_start"], [7, 1, 1, "", "on_predict_step_end"], [7, 1, 1, "", "on_train_end"], [7, 1, 1, "", "on_train_start"], [7, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.LearningRateMonitor": [[9, 1, 1, "", "on_train_epoch_start"], [9, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks.ModuleSummary": [[10, 1, 1, "", "on_eval_start"], [10, 1, 1, "", "on_predict_start"], [10, 1, 1, "", "on_train_start"]], "torchtnt.framework.callbacks.PyTorchProfiler": [[11, 1, 1, "", "on_eval_end"], [11, 1, 1, "", "on_eval_start"], [11, 1, 1, "", "on_eval_step_end"], [11, 1, 1, "", "on_predict_end"], [11, 1, 1, "", "on_predict_start"], [11, 1, 1, "", "on_predict_step_end"], [11, 1, 1, "", "on_train_end"], [11, 1, 1, "", "on_train_start"], [11, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.SystemResourcesMonitor": [[12, 1, 1, "", "on_eval_epoch_start"], [12, 1, 1, "", "on_eval_step_start"], [12, 1, 1, "", "on_predict_epoch_start"], [12, 1, 1, "", "on_predict_step_start"], [12, 1, 1, "", "on_train_epoch_start"], [12, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks.TQDMProgressBar": [[13, 1, 1, "", "on_eval_epoch_end"], [13, 1, 1, "", "on_eval_epoch_start"], [13, 1, 1, "", "on_eval_step_end"], [13, 1, 1, "", "on_predict_epoch_end"], [13, 1, 1, "", "on_predict_epoch_start"], [13, 1, 1, "", "on_predict_step_end"], [13, 1, 1, "", "on_train_epoch_end"], [13, 1, 1, "", "on_train_epoch_start"], [13, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.TensorBoardParameterMonitor": [[14, 1, 1, "", "on_train_epoch_end"]], "torchtnt.framework.callbacks.TorchSnapshotSaver": [[15, 3, 1, "", "dirpath"], [15, 1, 1, "", "get_latest_checkpoint_path"], [15, 1, 1, "", "on_exception"], [15, 1, 1, "", "on_train_end"], [15, 1, 1, "", "on_train_epoch_end"], [15, 1, 1, "", "on_train_start"], [15, 1, 1, "", "on_train_step_end"], [15, 1, 1, "", "restore"]], "torchtnt.framework.callbacks.TrainProgressMonitor": [[16, 1, 1, "", "on_train_epoch_end"], [16, 1, 1, "", "on_train_start"]], "torchtnt.framework.evaluate": [[4, 4, 1, "", "evaluate"]], "torchtnt.framework.fit": [[5, 4, 1, "", "fit"]], "torchtnt.framework.predict": [[17, 4, 1, "", "predict"]], "torchtnt.framework.state": [[18, 0, 1, "", "PhaseState"], [18, 0, 1, "", "State"]], "torchtnt.framework.state.PhaseState": [[18, 3, 1, "", "dataloader"], [18, 3, 1, "", "evaluate_every_n_epochs"], [18, 3, 1, "", "evaluate_every_n_steps"], [18, 3, 1, "", "max_epochs"], [18, 3, 1, "", "max_steps"], [18, 3, 1, "", "max_steps_per_epoch"], [18, 3, 1, "", "step_output"]], "torchtnt.framework.state.State": [[18, 3, 1, "", "active_phase"], [18, 3, 1, "", "entry_point"], [18, 3, 1, "", "eval_state"], [18, 3, 1, "", "predict_state"], [18, 3, 1, "", "should_stop"], [18, 1, 1, "", "stop"], [18, 3, 1, "", "timer"], [18, 3, 1, "", "train_state"]], "torchtnt.framework.train": [[19, 4, 1, "", "train"]], "torchtnt.framework.unit": [[20, 0, 1, "", "EvalUnit"], [20, 0, 1, "", "PredictUnit"], [20, 0, 1, "", "TrainUnit"]], "torchtnt.framework.unit.EvalUnit": [[20, 1, 1, "", "eval_step"], [20, 1, 1, "", "on_eval_end"], [20, 1, 1, "", "on_eval_epoch_end"], [20, 1, 1, "", "on_eval_epoch_start"], [20, 1, 1, "", "on_eval_start"]], "torchtnt.framework.unit.PredictUnit": [[20, 1, 1, "", "on_predict_end"], [20, 1, 1, "", "on_predict_epoch_end"], [20, 1, 1, "", "on_predict_epoch_start"], [20, 1, 1, "", "on_predict_start"], [20, 1, 1, "", "predict_step"]], "torchtnt.framework.unit.TrainUnit": [[20, 1, 1, "", "on_train_end"], [20, 1, 1, "", "on_train_epoch_end"], [20, 1, 1, "", "on_train_epoch_start"], [20, 1, 1, "", "on_train_start"], [20, 1, 1, "", "train_step"]], "torchtnt": [[35, 2, 0, "-", "utils"]], "torchtnt.utils": [[35, 0, 1, "", "CPUStats"], [35, 0, 1, "", "DDPStrategy"], [35, 0, 1, "", "EarlyStopChecker"], [35, 0, 1, "", "FSDPStrategy"], [35, 0, 1, "", "FlopTensorDispatchMode"], [35, 0, 1, "", "FullSyncPeriodicTimer"], [35, 0, 1, "", "GPUStats"], [35, 0, 1, "", "ModuleSummary"], [35, 0, 1, "", "PGWrapper"], [35, 0, 1, "", "Progress"], [35, 0, 1, "", "RSSProfiler"], [35, 0, 1, "", "Stateful"], [35, 5, 1, "", "TLRScheduler"], [35, 0, 1, "", "Timer"], [35, 4, 1, "", "all_gather_tensors"], [35, 4, 1, "", "attach_oom_observer"], [35, 4, 1, "", "barrier"], [35, 4, 1, "", "close_progress_bar"], [35, 4, 1, "", "copy_data_to_device"], [35, 4, 1, "", "create_progress_bar"], [22, 2, 0, "-", "data"], [35, 4, 1, "", "days_to_secs"], [35, 4, 1, "", "get_device_from_env"], [35, 4, 1, "", "get_filesystem"], [35, 4, 1, "", "get_global_rank"], [35, 4, 1, "", "get_local_rank"], [35, 4, 1, "", "get_module_summary"], [35, 4, 1, "", "get_nvidia_smi_gpu_stats"], [35, 4, 1, "", "get_process_group_backend_from_device"], [35, 4, 1, "", "get_psutil_cpu_stats"], [35, 4, 1, "", "get_python_version"], [35, 4, 1, "", "get_summary_table"], [35, 4, 1, "", "get_tensor_size_bytes_map"], [35, 4, 1, "", "get_timer_summary"], [35, 4, 1, "", "get_torch_version"], [35, 4, 1, "", "get_world_size"], [35, 4, 1, "", "init_from_env"], [35, 4, 1, "", "is_out_of_cpu_memory"], [35, 4, 1, "", "is_out_of_cuda_memory"], [35, 4, 1, "", "is_out_of_memory_error"], [35, 4, 1, "", "is_torch_version_ge_1_13_1"], [35, 4, 1, "", "is_torch_version_geq_1_10"], [35, 4, 1, "", "is_torch_version_geq_1_11"], [35, 4, 1, "", "is_torch_version_geq_1_12"], [35, 4, 1, "", "is_torch_version_geq_1_13"], [35, 4, 1, "", "is_torch_version_geq_1_14"], [35, 4, 1, "", "is_torch_version_geq_1_8"], [35, 4, 1, "", "is_torch_version_geq_1_9"], [35, 4, 1, "", "is_torch_version_geq_2_0"], [35, 4, 1, "", "is_windows"], [35, 4, 1, "", "log_elapsed_time"], [35, 4, 1, "", "log_memory_snapshot"], [34, 2, 0, "-", "loggers"], [35, 4, 1, "", "maybe_enable_tf32"], [35, 4, 1, "", "measure_rss_deltas"], [35, 4, 1, "", "prepare_ddp"], [35, 4, 1, "", "prepare_fsdp"], [35, 4, 1, "", "prune_module_summary"], [35, 4, 1, "", "rank_zero_critical"], [35, 4, 1, "", "rank_zero_debug"], [35, 4, 1, "", "rank_zero_error"], [35, 4, 1, "", "rank_zero_info"], [35, 4, 1, "", "rank_zero_print"], [35, 4, 1, "", "rank_zero_warn"], [35, 4, 1, "", "record_data_in_stream"], [35, 4, 1, "", "seed"], [35, 4, 1, "", "sync_bool"], [35, 4, 1, "", "transfer_batch_norm_stats"], [35, 4, 1, "", "transfer_weights"], [35, 4, 1, "", "update_progress_bar"]], "torchtnt.utils.CPUStats": [[35, 5, 1, "", "cpu_percent"], [35, 5, 1, "", "cpu_swap_percent"], [35, 5, 1, "", "cpu_vm_percent"], [35, 5, 1, "", "worker_cpu_time_system"], [35, 5, 1, "", "worker_cpu_time_user"], [35, 5, 1, "", "worker_rss"]], "torchtnt.utils.DDPStrategy": [[35, 5, 1, "", "broadcast_buffers"], [35, 5, 1, "", "bucket_cap_mb"], [35, 5, 1, "", "check_reduction"], [35, 5, 1, "", "comm_hook"], [35, 5, 1, "", "comm_state"], [35, 5, 1, "", "dim"], [35, 5, 1, "", "find_unused_parameters"], [35, 5, 1, "", "gradient_as_bucket_view"], [35, 5, 1, "", "output_device"], [35, 5, 1, "", "process_group"], [35, 5, 1, "", "static_graph"], [35, 5, 1, "", "sync_batchnorm"]], "torchtnt.utils.EarlyStopChecker": [[35, 1, 1, "", "check"], [35, 3, 1, "", "check_finite"], [35, 3, 1, "", "divergence_threshold"], [35, 1, 1, "", "load_state_dict"], [35, 3, 1, "", "min_delta"], [35, 3, 1, "", "mode"], [35, 3, 1, "", "patience"], [35, 1, 1, "", "reset"], [35, 1, 1, "", "state_dict"], [35, 3, 1, "", "stopping_threshold"], [35, 3, 1, "", "threshold_mode"]], "torchtnt.utils.FSDPStrategy": [[35, 5, 1, "", "auto_wrap_policy"], [35, 5, 1, "", "backward_prefetch"], [35, 5, 1, "", "cpu_offload"], [35, 5, 1, "", "forward_prefetch"], [35, 5, 1, "", "ignored_modules"], [35, 5, 1, "", "limit_all_gathers"], [35, 5, 1, "", "optim_state_dict_config"], [35, 5, 1, "", "process_group"], [35, 5, 1, "", "sharding_strategy"], [35, 5, 1, "", "state_dict_config"], [35, 5, 1, "", "state_dict_type"], [35, 5, 1, "", "sync_module_states"], [35, 5, 1, "", "use_orig_params"]], "torchtnt.utils.FlopTensorDispatchMode": [[35, 1, 1, "", "reset"]], "torchtnt.utils.FullSyncPeriodicTimer": [[35, 1, 1, "", "check"]], "torchtnt.utils.GPUStats": [[35, 5, 1, "", "fan_speed_percent"], [35, 5, 1, "", "memory_free_mb"], [35, 5, 1, "", "memory_used_mb"], [35, 5, 1, "", "temperature_gpu_celsius"], [35, 5, 1, "", "temperature_memory_celsius"], [35, 5, 1, "", "utilization_gpu_percent"], [35, 5, 1, "", "utilization_memory_percent"]], "torchtnt.utils.ModuleSummary": [[35, 3, 1, "", "flops_backward"], [35, 3, 1, "", "flops_forward"], [35, 3, 1, "", "forward_elapsed_time_ms"], [35, 3, 1, "", "has_uninitialized_param"], [35, 3, 1, "", "in_size"], [35, 3, 1, "", "module_name"], [35, 3, 1, "", "module_type"], [35, 3, 1, "", "num_parameters"], [35, 3, 1, "", "num_trainable_parameters"], [35, 3, 1, "", "out_size"], [35, 3, 1, "", "size_bytes"], [35, 3, 1, "", "submodule_summaries"]], "torchtnt.utils.PGWrapper": [[35, 1, 1, "", "all_gather_object"], [35, 1, 1, "", "barrier"], [35, 1, 1, "", "broadcast_object_list"], [35, 1, 1, "", "get_rank"], [35, 1, 1, "", "get_world_size"], [35, 1, 1, "", "scatter_object_list"]], "torchtnt.utils.Progress": [[35, 1, 1, "", "increment_epoch"], [35, 1, 1, "", "increment_step"], [35, 1, 1, "", "load_state_dict"], [35, 3, 1, "", "num_epochs_completed"], [35, 3, 1, "", "num_steps_completed"], [35, 3, 1, "", "num_steps_completed_in_epoch"], [35, 1, 1, "", "state_dict"]], "torchtnt.utils.RSSProfiler": [[35, 5, 1, "", "interval"], [35, 1, 1, "", "profile"], [35, 1, 1, "", "reset"], [35, 5, 1, "", "rss_deltas_bytes"]], "torchtnt.utils.Stateful": [[35, 1, 1, "", "load_state_dict"], [35, 1, 1, "", "state_dict"]], "torchtnt.utils.Timer": [[35, 1, 1, "", "reset"], [35, 1, 1, "", "time"]], "torchtnt.utils.data": [[23, 0, 1, "", "AllDatasetBatchesIterator"], [24, 0, 1, "", "CudaDataPrefetcher"], [25, 0, 1, "", "InOrderIterator"], [26, 0, 1, "", "MultiDataLoader"], [27, 0, 1, "", "MultiIterator"], [28, 0, 1, "", "RandomizedBatchSamplerIterator"], [29, 0, 1, "", "RoundRobinIterator"]], "torchtnt.utils.data.MultiDataLoader": [[26, 5, 1, "", "ignore_empty_data"], [26, 5, 1, "", "individual_dataloaders"], [26, 5, 1, "", "iteration_strategy"], [26, 5, 1, "", "iterator_cls"], [26, 1, 1, "", "load_state_dict"], [26, 1, 1, "", "state_dict"]], "torchtnt.utils.loggers": [[30, 0, 1, "", "CSVLogger"], [34, 0, 1, "", "FileLogger"], [31, 0, 1, "", "InMemoryLogger"], [32, 0, 1, "", "JSONLogger"], [34, 0, 1, "", "MetricLogger"], [33, 0, 1, "", "TensorBoardLogger"]], "torchtnt.utils.loggers.CSVLogger": [[30, 1, 1, "", "close"]], "torchtnt.utils.loggers.FileLogger": [[34, 1, 1, "", "close"], [34, 1, 1, "", "flush"], [34, 1, 1, "", "log"], [34, 1, 1, "", "log_dict"], [34, 3, 1, "", "path"]], "torchtnt.utils.loggers.InMemoryLogger": [[31, 1, 1, "", "close"], [31, 1, 1, "", "log"], [31, 3, 1, "", "log_buffer"], [31, 1, 1, "", "log_dict"]], "torchtnt.utils.loggers.JSONLogger": [[32, 1, 1, "", "close"]], "torchtnt.utils.loggers.MetricLogger": [[34, 1, 1, "", "close"], [34, 1, 1, "", "log"], [34, 1, 1, "", "log_dict"]], "torchtnt.utils.loggers.TensorBoardLogger": [[33, 1, 1, "", "close"], [33, 1, 1, "", "flush"], [33, 1, 1, "", "log"], [33, 1, 1, "", "log_audio"], [33, 1, 1, "", "log_dict"], [33, 1, 1, "", "log_hparams"], [33, 1, 1, "", "log_image"], [33, 1, 1, "", "log_images"], [33, 1, 1, "", "log_text"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:module", "3": "py:property", "4": "py:function", "5": "py:attribute"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "module", "Python module"], "3": ["py", "property", "Python property"], "4": ["py", "function", "Python function"], "5": ["py", "attribute", "Python attribute"]}, "titleterms": {"distribut": [0, 21], "train": [0, 1, 19], "data": [0, 22], "parallel": 0, "fulli": 0, "shard": 0, "exampl": [1, 21], "trainunit": [1, 20], "autounit": [1, 2], "torchdata": 1, "mnist": 1, "mingpt": 1, "torchrec": 1, "callback": 3, "built": [3, 34], "evalu": 4, "entri": [4, 5, 17, 19], "point": [4, 5, 17, 19], "fit": 5, "basecsvwrit": 6, "garbagecollector": 7, "lambda": 8, "learningratemonitor": 9, "modulesummari": 10, "pytorchprofil": 11, "systemresourcesmonitor": 12, "tqdmprogressbar": 13, "tensorboardparametermonitor": 14, "torchsnapshotsav": 15, "trainprogressmonitor": 16, "predict": 17, "state": 18, "phasest": 18, "unit": 20, "evalunit": 20, "predictunit": 20, "combin": 20, "multipl": 20, "welcom": 21, "torchtnt": 21, "document": 21, "instal": 21, "framework": 21, "util": [21, 35], "alldatasetbatchesiter": 23, "cudadataprefetch": 24, "inorderiter": 25, "multidataload": 26, "multiiter": 27, "randomizedbatchsampleriter": 28, "roundrobiniter": 29, "csvlogger": 30, "inmemorylogg": 31, "jsonlogg": 32, "tensorboardlogg": 33, "logger": 34}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 56}})